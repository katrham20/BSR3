<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BSR: B-spline atomic R-matrix codes: Bsr_mat</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BSR: B-spline atomic R-matrix codes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Bsr_mat</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generate the interaction matrixes in B-spline representation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:gaecc5c7144cc305a1692709b811ee0022"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaecc5c7144cc305a1692709b811ee0022">add_cdata</a> (ip, jp, C, <a class="el" href="_d_b_s__core_8f90.html#adb1420ceddc2be1411560d4b4d3257e3">j1</a>, <a class="el" href="_d_b_s__core_8f90.html#a56cac856c78a3e6fe83db83b30cb6106">j2</a>, j3, j4)</td></tr>
<tr class="memdesc:gaecc5c7144cc305a1692709b811ee0022"><td class="mdescLeft">&#160;</td><td class="mdescRight">add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata  <a href="group__bsr__mat.html#gaecc5c7144cc305a1692709b811ee0022">More...</a><br /></td></tr>
<tr class="separator:gaecc5c7144cc305a1692709b811ee0022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca8bcb501ac0147d13aa3bfbd9a5a934"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaca8bcb501ac0147d13aa3bfbd9a5a934">add_coef</a> (C, <a class="el" href="_d_b_s__core_8f90.html#adb1420ceddc2be1411560d4b4d3257e3">j1</a>, <a class="el" href="_d_b_s__core_8f90.html#a56cac856c78a3e6fe83db83b30cb6106">j2</a>, j3, j4)</td></tr>
<tr class="separator:gaca8bcb501ac0147d13aa3bfbd9a5a934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4b084bd6e249e6378845de9a56b81fd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gab4b084bd6e249e6378845de9a56b81fd">bs_orth</a></td></tr>
<tr class="separator:gab4b084bd6e249e6378845de9a56b81fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ab1de4a750178e1755ee67a80431932"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga0ab1de4a750178e1755ee67a80431932">bsr_mat_inf</a></td></tr>
<tr class="separator:ga0ab1de4a750178e1755ee67a80431932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8005bfea023f4e763e7b1aec30de7cee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga8005bfea023f4e763e7b1aec30de7cee">check_det</a> (kdn, N1, N2, iext)</td></tr>
<tr class="memdesc:ga8005bfea023f4e763e7b1aec30de7cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">expend the total overlap determinant so that to extract one-electron overlaps with continuum orbitals  <a href="group__bsr__mat.html#ga8005bfea023f4e763e7b1aec30de7cee">More...</a><br /></td></tr>
<tr class="separator:ga8005bfea023f4e763e7b1aec30de7cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7609207df74422f8b2758f1a48de118d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga7609207df74422f8b2758f1a48de118d">shift</a> (<a class="el" href="_b_s_2splin3_8f90.html#a852381143d9266abcddc6861cb77d6d4">n</a>, <a class="el" href="_b_s_2splin3_8f90.html#a599fed65f96e49980db577206ec1e670">m</a>, N1, N2)</td></tr>
<tr class="memdesc:ga7609207df74422f8b2758f1a48de118d"><td class="mdescLeft">&#160;</td><td class="mdescRight">array N2 obtained from array N1 by deleting element 'm'  <a href="group__bsr__mat.html#ga7609207df74422f8b2758f1a48de118d">More...</a><br /></td></tr>
<tr class="separator:ga7609207df74422f8b2758f1a48de118d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5f049653c4071f1926f39c91ead5168"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae5f049653c4071f1926f39c91ead5168">check_mat</a> (met)</td></tr>
<tr class="memdesc:gae5f049653c4071f1926f39c91ead5168"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the overlap matrix for big overlaps and assign new orthogonality conditions if needed  <a href="group__bsr__mat.html#gae5f049653c4071f1926f39c91ead5168">More...</a><br /></td></tr>
<tr class="separator:gae5f049653c4071f1926f39c91ead5168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90c3451b67ceab57cb6bdea6dfd91f60"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga90c3451b67ceab57cb6bdea6dfd91f60">det_fact</a> (idf, IPN1, IPN2)</td></tr>
<tr class="separator:ga90c3451b67ceab57cb6bdea6dfd91f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e417b1eb2333d1787f33a4e54936605"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga5e417b1eb2333d1787f33a4e54936605">f_values</a></td></tr>
<tr class="separator:ga5e417b1eb2333d1787f33a4e54936605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f53371f0a86dae4b72d31aba3564bff"><td class="memItemLeft" align="right" valign="top">real(8) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga2f53371f0a86dae4b72d31aba3564bff">reduce_factor</a> (ich, jch, <a class="el" href="_d_b_s__core_8f90.html#af22c486581933c52df7d4aa306382074">k</a>)</td></tr>
<tr class="memdesc:ga2f53371f0a86dae4b72d31aba3564bff"><td class="mdescLeft">&#160;</td><td class="mdescRight">define factor connecing reduced dipole matrix element with asymptotic coefficient for multipole index k  <a href="group__bsr__mat.html#ga2f53371f0a86dae4b72d31aba3564bff">More...</a><br /></td></tr>
<tr class="separator:ga2f53371f0a86dae4b72d31aba3564bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee20a200065c16a15bd939770e0b49dd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaee20a200065c16a15bd939770e0b49dd">gen_matrix</a> (jtype, jpol)</td></tr>
<tr class="memdesc:gaee20a200065c16a15bd939770e0b49dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">merge data and generate the interaction matrix for current itype  <a href="group__bsr__mat.html#gaee20a200065c16a15bd939770e0b49dd">More...</a><br /></td></tr>
<tr class="separator:gaee20a200065c16a15bd939770e0b49dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75783f72551fe654ab29d55bf336d369"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga75783f72551fe654ab29d55bf336d369">get_v</a> (<a class="el" href="_d_b_s__core_8f90.html#adb63a7b92114f4c7f3419a3a7ed71a16">ii</a>, <a class="el" href="_d_b_s__core_8f90.html#a9563c3f318a9686be7815aabe1b9a83a">jj</a>, <a class="el" href="_d_b_s__core_8f90.html#a3826b2426c89afe924cd76c7c994af5d">v</a>)</td></tr>
<tr class="separator:ga75783f72551fe654ab29d55bf336d369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4884f97fcff28a8fb16a879d24722743"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga4884f97fcff28a8fb16a879d24722743">i_data</a> (jtype, jpol)</td></tr>
<tr class="separator:ga4884f97fcff28a8fb16a879d24722743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga609bbd7fa970c4d6290468a42a395906"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga609bbd7fa970c4d6290468a42a395906">ifind_channel_serial</a> (ic)</td></tr>
<tr class="memdesc:ga609bbd7fa970c4d6290468a42a395906"><td class="mdescLeft">&#160;</td><td class="mdescRight">find channel (or perturber) for given configuration 'ic'  <a href="group__bsr__mat.html#ga609bbd7fa970c4d6290468a42a395906">More...</a><br /></td></tr>
<tr class="separator:ga609bbd7fa970c4d6290468a42a395906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2727469ba9e20d91a6158dc13880a30a"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga2727469ba9e20d91a6158dc13880a30a">idef_itype</a> (<a class="el" href="_d_b_s__core_8f90.html#af963619ce97fcda891257c2a296fc0b9">i1</a>, <a class="el" href="_d_b_s__core_8f90.html#a5f589bc83e55eecc5b1c372de3376ea9">i2</a>, i3, i4, io, jo, ic, jc, k1, k2, k3, k4, ibi)</td></tr>
<tr class="separator:ga2727469ba9e20d91a6158dc13880a30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cd5a33848d99e56fd504fe053d3e5f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga5cd5a33848d99e56fd504fe053d3e5f7">inf_bsr_mat</a></td></tr>
<tr class="separator:ga5cd5a33848d99e56fd504fe053d3e5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea49348f90e755d41a4720c7b4b925cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaea49348f90e755d41a4720c7b4b925cd">jsym_int</a> (met, <a class="el" href="_d_b_s__core_8f90.html#af963619ce97fcda891257c2a296fc0b9">i1</a>, <a class="el" href="_d_b_s__core_8f90.html#a5f589bc83e55eecc5b1c372de3376ea9">i2</a>, i3, i4)</td></tr>
<tr class="separator:gaea49348f90e755d41a4720c7b4b925cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9d7256efddcadb09785f06f0b1b9431"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae9d7256efddcadb09785f06f0b1b9431">alloc_lcore</a> (ns, ks, nbf)</td></tr>
<tr class="memdesc:gae9d7256efddcadb09785f06f0b1b9431"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate (deallocate) arrays in module L_core  <a href="group__bsr__mat.html#gae9d7256efddcadb09785f06f0b1b9431">More...</a><br /></td></tr>
<tr class="separator:gae9d7256efddcadb09785f06f0b1b9431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56cddcf4108a3b0a144e49f655e70e4e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga56cddcf4108a3b0a144e49f655e70e4e">gen_lval</a></td></tr>
<tr class="separator:ga56cddcf4108a3b0a144e49f655e70e4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49eb8485de3fa2b69600b916b3f294e7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga49eb8485de3fa2b69600b916b3f294e7">int_core</a> (l)</td></tr>
<tr class="memdesc:ga49eb8485de3fa2b69600b916b3f294e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">generate B-spline representation for interaction with core  <a href="group__bsr__mat.html#ga49eb8485de3fa2b69600b916b3f294e7">More...</a><br /></td></tr>
<tr class="separator:ga49eb8485de3fa2b69600b916b3f294e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae9277a5b04cada2d259fa5990dd98d8f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae9277a5b04cada2d259fa5990dd98d8f">mvcv</a> (l, vc)</td></tr>
<tr class="separator:gae9277a5b04cada2d259fa5990dd98d8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31f955cb753cd82e1443578a0e05cf55"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga31f955cb753cd82e1443578a0e05cf55">l_data</a> (jtype, l)</td></tr>
<tr class="separator:ga31f955cb753cd82e1443578a0e05cf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb61b6365a22b464545b654107a56915"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gacb61b6365a22b464545b654107a56915">merge_cdata</a> (nn, ip, jp, nc, eps_cc)</td></tr>
<tr class="separator:gacb61b6365a22b464545b654107a56915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga021aa58b6d137adbbfe6ad8228ad87d0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga021aa58b6d137adbbfe6ad8228ad87d0">allocate_cmdata</a></td></tr>
<tr class="separator:ga021aa58b6d137adbbfe6ad8228ad87d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6262addd2372f5b910f065c5e9e2c9cb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga6262addd2372f5b910f065c5e9e2c9cb">initilize_cmdata</a></td></tr>
<tr class="separator:ga6262addd2372f5b910f065c5e9e2c9cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga022f005e9c5a726e0aafbfe841c8dbcb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga022f005e9c5a726e0aafbfe841c8dbcb">read_dets</a></td></tr>
<tr class="separator:ga022f005e9c5a726e0aafbfe841c8dbcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78af874d39aa31ced6aff5f113b4bf94"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga78af874d39aa31ced6aff5f113b4bf94">allocate_matrix</a> (nch, ns, ncp, <a class="el" href="_r_a_d_i_a_l_2zint_8f90.html#a742b2f716e44fb7944c8e21ecc31ba98">mk</a>, ncfg)</td></tr>
<tr class="memdesc:ga78af874d39aa31ced6aff5f113b4bf94"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a>  <a href="group__bsr__mat.html#ga78af874d39aa31ced6aff5f113b4bf94">More...</a><br /></td></tr>
<tr class="separator:ga78af874d39aa31ced6aff5f113b4bf94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ec3b742ec7541197da9e9a49bb7c3b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga8ec3b742ec7541197da9e9a49bb7c3b7">update_hx</a> (ich, jch, ns, ks, <a class="el" href="_b_s_2splin3_8f90.html#a7db533a94595eeb5a76807f817790b1c">d</a>, sym)</td></tr>
<tr class="memdesc:ga8ec3b742ec7541197da9e9a49bb7c3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">update channel block  <a href="group__bsr__mat.html#ga8ec3b742ec7541197da9e9a49bb7c3b7">More...</a><br /></td></tr>
<tr class="separator:ga8ec3b742ec7541197da9e9a49bb7c3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7677a4f429f4e454fa43e7daf2b0d918"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga7677a4f429f4e454fa43e7daf2b0d918">update_hl</a> (ich, jch, ns, ks, <a class="el" href="_b_s_2splin3_8f90.html#a7db533a94595eeb5a76807f817790b1c">d</a>, <a class="el" href="_d_b_s__core_8f90.html#a223a3a38b8ffe07fbcb8919f258292da">c</a>)</td></tr>
<tr class="memdesc:ga7677a4f429f4e454fa43e7daf2b0d918"><td class="mdescLeft">&#160;</td><td class="mdescRight">update symmetric banded matrix in lower-column storage mode !  <a href="group__bsr__mat.html#ga7677a4f429f4e454fa43e7daf2b0d918">More...</a><br /></td></tr>
<tr class="separator:ga7677a4f429f4e454fa43e7daf2b0d918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9cf44c0c9fc5ad2dd435599ea85f4fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gac9cf44c0c9fc5ad2dd435599ea85f4fc">update_hb</a> (ic, jc, <a class="el" href="_d_b_s__core_8f90.html#a223a3a38b8ffe07fbcb8919f258292da">c</a>)</td></tr>
<tr class="memdesc:gac9cf44c0c9fc5ad2dd435599ea85f4fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">update scalar in the bound-bound block  <a href="group__bsr__mat.html#gac9cf44c0c9fc5ad2dd435599ea85f4fc">More...</a><br /></td></tr>
<tr class="separator:gac9cf44c0c9fc5ad2dd435599ea85f4fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga579285c9aa90774a8452e7d02f54507d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga579285c9aa90774a8452e7d02f54507d">update_hv</a> (ich, ic, ns, <a class="el" href="_d_b_s__core_8f90.html#a3826b2426c89afe924cd76c7c994af5d">v</a>, <a class="el" href="_d_b_s__core_8f90.html#a223a3a38b8ffe07fbcb8919f258292da">c</a>)</td></tr>
<tr class="memdesc:ga579285c9aa90774a8452e7d02f54507d"><td class="mdescLeft">&#160;</td><td class="mdescRight">update vector in the channel-bound block  <a href="group__bsr__mat.html#ga579285c9aa90774a8452e7d02f54507d">More...</a><br /></td></tr>
<tr class="separator:ga579285c9aa90774a8452e7d02f54507d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa8bf8509f43227d5f00d3d0f423939f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaaa8bf8509f43227d5f00d3d0f423939f">update_hw</a> (ich, jch, ns, <a class="el" href="_d_b_s__core_8f90.html#a3826b2426c89afe924cd76c7c994af5d">v</a>, w)</td></tr>
<tr class="memdesc:gaaa8bf8509f43227d5f00d3d0f423939f"><td class="mdescLeft">&#160;</td><td class="mdescRight">update channel block with by v*w  <a href="group__bsr__mat.html#gaaa8bf8509f43227d5f00d3d0f423939f">More...</a><br /></td></tr>
<tr class="separator:gaaa8bf8509f43227d5f00d3d0f423939f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b5b0c928f5bd0959e03c3d23f136fe5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga1b5b0c928f5bd0959e03c3d23f136fe5">update_cf</a> (<a class="el" href="_d_b_s__core_8f90.html#af22c486581933c52df7d4aa306382074">k</a>, ich, jch, C)</td></tr>
<tr class="memdesc:ga1b5b0c928f5bd0959e03c3d23f136fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update asymptotic coefficients.  <a href="group__bsr__mat.html#ga1b5b0c928f5bd0959e03c3d23f136fe5">More...</a><br /></td></tr>
<tr class="separator:ga1b5b0c928f5bd0959e03c3d23f136fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38c33a8251c1d7e2759702c9ebad6f06"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga38c33a8251c1d7e2759702c9ebad6f06">target_h</a> (ich, jch, C, CC)</td></tr>
<tr class="separator:ga38c33a8251c1d7e2759702c9ebad6f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae18d8db1b226e35e6280aff288338a80"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae18d8db1b226e35e6280aff288338a80">target_print</a> (iout, EC, eps)</td></tr>
<tr class="memdesc:gae18d8db1b226e35e6280aff288338a80"><td class="mdescLeft">&#160;</td><td class="mdescRight">prints target info  <a href="group__bsr__mat.html#gae18d8db1b226e35e6280aff288338a80">More...</a><br /></td></tr>
<tr class="separator:gae18d8db1b226e35e6280aff288338a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a63e173bdc2dbf0377b174dc162ef1e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga3a63e173bdc2dbf0377b174dc162ef1e">target_new</a></td></tr>
<tr class="separator:ga3a63e173bdc2dbf0377b174dc162ef1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8e42d9d606df9bcaecf1b767e5106b5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae8e42d9d606df9bcaecf1b767e5106b5">allocate_ndefs</a> (<a class="el" href="_b_s_2splin3_8f90.html#a599fed65f96e49980db577206ec1e670">m</a>)</td></tr>
<tr class="memdesc:gae8e42d9d606df9bcaecf1b767e5106b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate arrays in module ndefs  <a href="group__bsr__mat.html#gae8e42d9d606df9bcaecf1b767e5106b5">More...</a><br /></td></tr>
<tr class="separator:gae8e42d9d606df9bcaecf1b767e5106b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga264a971a9f0ec5398f4dc7ad48817982"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga264a971a9f0ec5398f4dc7ad48817982">iadd_ndefs</a> (io, jo, S)</td></tr>
<tr class="memdesc:ga264a971a9f0ec5398f4dc7ad48817982"><td class="mdescLeft">&#160;</td><td class="mdescRight">add new overlap factor if S &gt; Eps_det  <a href="group__bsr__mat.html#ga264a971a9f0ec5398f4dc7ad48817982">More...</a><br /></td></tr>
<tr class="separator:ga264a971a9f0ec5398f4dc7ad48817982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab18fa91f9ef0a4fa46223eb20984b401"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gab18fa91f9ef0a4fa46223eb20984b401">allocate_ndets</a> (<a class="el" href="_b_s_2splin3_8f90.html#a599fed65f96e49980db577206ec1e670">m</a>)</td></tr>
<tr class="memdesc:gab18fa91f9ef0a4fa46223eb20984b401"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate arrays in module ndets  <a href="group__bsr__mat.html#gab18fa91f9ef0a4fa46223eb20984b401">More...</a><br /></td></tr>
<tr class="separator:gab18fa91f9ef0a4fa46223eb20984b401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50885f1ee12bb74c53e7e1cc3d576806"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga50885f1ee12bb74c53e7e1cc3d576806">iadd_ndets</a> (io, jo, S)</td></tr>
<tr class="memdesc:ga50885f1ee12bb74c53e7e1cc3d576806"><td class="mdescLeft">&#160;</td><td class="mdescRight">add new determinat overlap if S &gt; Eps_det  <a href="group__bsr__mat.html#ga50885f1ee12bb74c53e7e1cc3d576806">More...</a><br /></td></tr>
<tr class="separator:ga50885f1ee12bb74c53e7e1cc3d576806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3361f70e89302ec2c692df11ae50028a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga3361f70e89302ec2c692df11ae50028a">o_data</a></td></tr>
<tr class="separator:ga3361f70e89302ec2c692df11ae50028a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6046b07a0612b9253dbf40fa45cd7fa3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga6046b07a0612b9253dbf40fa45cd7fa3">pri_int</a> (nu, icase, <a class="el" href="_d_b_s__core_8f90.html#af22c486581933c52df7d4aa306382074">k</a>, <a class="el" href="_d_b_s__core_8f90.html#af963619ce97fcda891257c2a296fc0b9">i1</a>, <a class="el" href="_d_b_s__core_8f90.html#a5f589bc83e55eecc5b1c372de3376ea9">i2</a>, i3, i4, S)</td></tr>
<tr class="memdesc:ga6046b07a0612b9253dbf40fa45cd7fa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">print the integral for debug purposes  <a href="group__bsr__mat.html#ga6046b07a0612b9253dbf40fa45cd7fa3">More...</a><br /></td></tr>
<tr class="separator:ga6046b07a0612b9253dbf40fa45cd7fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e76be764ac0eec49ea1f658c431f0b4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga3e76be764ac0eec49ea1f658c431f0b4">read_arg</a> (nu)</td></tr>
<tr class="memdesc:ga3e76be764ac0eec49ea1f658c431f0b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">read input parameters  <a href="group__bsr__mat.html#ga3e76be764ac0eec49ea1f658c431f0b4">More...</a><br /></td></tr>
<tr class="separator:ga3e76be764ac0eec49ea1f658c431f0b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16b40b53422dc67fe65cf793458d956b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga16b40b53422dc67fe65cf793458d956b">read_bsw</a> (nu)</td></tr>
<tr class="separator:ga16b40b53422dc67fe65cf793458d956b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0e423f95e4e3d38efddcd41b370d0cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gae0e423f95e4e3d38efddcd41b370d0cd">read_conf</a> (nuc, nub)</td></tr>
<tr class="separator:gae0e423f95e4e3d38efddcd41b370d0cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae3f5c99fcf27fce39382bb506c6ca50"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaae3f5c99fcf27fce39382bb506c6ca50">read_data</a></td></tr>
<tr class="separator:gaae3f5c99fcf27fce39382bb506c6ca50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga674f2cb9ac4e85268ece9a306f1f7965"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga674f2cb9ac4e85268ece9a306f1f7965">record_matrix</a> (nu)</td></tr>
<tr class="memdesc:ga674f2cb9ac4e85268ece9a306f1f7965"><td class="mdescLeft">&#160;</td><td class="mdescRight">record interaction (overlap) matrix to the unit 'nu'  <a href="group__bsr__mat.html#ga674f2cb9ac4e85268ece9a306f1f7965">More...</a><br /></td></tr>
<tr class="separator:ga674f2cb9ac4e85268ece9a306f1f7965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec39886073e72965c1d3b0438b03e243"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaec39886073e72965c1d3b0438b03e243">state_res</a></td></tr>
<tr class="separator:gaec39886073e72965c1d3b0438b03e243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40c2d1441db2c6dbe37c5c433560f8c7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga40c2d1441db2c6dbe37c5c433560f8c7">sub1</a></td></tr>
<tr class="separator:ga40c2d1441db2c6dbe37c5c433560f8c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5916f9f05e8e66f538f9a4196d13af1"><td class="memItemLeft" align="right" valign="top">real(8) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaa5916f9f05e8e66f538f9a4196d13af1">vdet</a> (kd, N1, N2)</td></tr>
<tr class="memdesc:gaa5916f9f05e8e66f538f9a4196d13af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the value of overlap determinant for given orbitals Calls: DET  <a href="group__bsr__mat.html#gaa5916f9f05e8e66f538f9a4196d13af1">More...</a><br /></td></tr>
<tr class="separator:gaa5916f9f05e8e66f538f9a4196d13af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08f4166bf9b9cd3735b9a7cfbce476e0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga08f4166bf9b9cd3735b9a7cfbce476e0">alloc_zcore</a> (ns, ks, nbf)</td></tr>
<tr class="memdesc:ga08f4166bf9b9cd3735b9a7cfbce476e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate arrays in module Z_core  <a href="group__bsr__mat.html#ga08f4166bf9b9cd3735b9a7cfbce476e0">More...</a><br /></td></tr>
<tr class="separator:ga08f4166bf9b9cd3735b9a7cfbce476e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe0b04565ad7519f523707bf01ff0eda"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gafe0b04565ad7519f523707bf01ff0eda">gen_zval</a></td></tr>
<tr class="separator:gafe0b04565ad7519f523707bf01ff0eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5dd32e07d22034a2568fd1356a9f0a80"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga5dd32e07d22034a2568fd1356a9f0a80">intz_core</a> (l)</td></tr>
<tr class="memdesc:ga5dd32e07d22034a2568fd1356a9f0a80"><td class="mdescLeft">&#160;</td><td class="mdescRight">generate B-splne representation in array zl_core for Z-integrals with core interaction for given l  <a href="group__bsr__mat.html#ga5dd32e07d22034a2568fd1356a9f0a80">More...</a><br /></td></tr>
<tr class="separator:ga5dd32e07d22034a2568fd1356a9f0a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4247a44666ad6f229792e15bb0dfa93c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga4247a44666ad6f229792e15bb0dfa93c">gen_zzeta</a> (rm, izcorr)</td></tr>
<tr class="memdesc:ga4247a44666ad6f229792e15bb0dfa93c"><td class="mdescLeft">&#160;</td><td class="mdescRight">B-spline matrix for Z*fine*1/r^3, Used for spin-orbit interaction; if izcorr &gt; 0, multiplied with correction r/(r+2*z*fine)  <a href="group__bsr__mat.html#ga4247a44666ad6f229792e15bb0dfa93c">More...</a><br /></td></tr>
<tr class="separator:ga4247a44666ad6f229792e15bb0dfa93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86aad19d1517654fef57ae806dbf8927"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga86aad19d1517654fef57ae806dbf8927">z_data</a> (jtype, l)</td></tr>
<tr class="separator:ga86aad19d1517654fef57ae806dbf8927"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga9e6abf295659518186a90e82f5225f75"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga9e6abf295659518186a90e82f5225f75">l_core::lh_dir</a></td></tr>
<tr class="memdesc:ga9e6abf295659518186a90e82f5225f75"><td class="mdescLeft">&#160;</td><td class="mdescRight">contain B-spline representation for L-integral including the interaction with common core  <a href="group__bsr__mat.html#ga9e6abf295659518186a90e82f5225f75">More...</a><br /></td></tr>
<tr class="separator:ga9e6abf295659518186a90e82f5225f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3e82e5aaa6dbd55b62a26d696f5ddc9"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gaf3e82e5aaa6dbd55b62a26d696f5ddc9">bsr_matrix::kch</a></td></tr>
<tr class="separator:gaf3e82e5aaa6dbd55b62a26d696f5ddc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8b59f259bef35dc4d68f1cb8102ca76"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#gac8b59f259bef35dc4d68f1cb8102ca76">bsr_mat::ma</a> =20</td></tr>
<tr class="memdesc:gac8b59f259bef35dc4d68f1cb8102ca76"><td class="mdescLeft">&#160;</td><td class="mdescRight">main parameters for the BSR_MAT program  <a href="group__bsr__mat.html#gac8b59f259bef35dc4d68f1cb8102ca76">More...</a><br /></td></tr>
<tr class="separator:gac8b59f259bef35dc4d68f1cb8102ca76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1307721a915029971f2d37812bc53c39"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsr__mat.html#ga1307721a915029971f2d37812bc53c39">z_core::lz_dir</a></td></tr>
<tr class="memdesc:ga1307721a915029971f2d37812bc53c39"><td class="mdescLeft">&#160;</td><td class="mdescRight">contains B-splne representation for Z-integral including the interaction with core  <a href="group__bsr__mat.html#ga1307721a915029971f2d37812bc53c39">More...</a><br /></td></tr>
<tr class="separator:ga1307721a915029971f2d37812bc53c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Generate the interaction matrixes in B-spline representation. </p>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="gaecc5c7144cc305a1692709b811ee0022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaecc5c7144cc305a1692709b811ee0022">&#9670;&nbsp;</a></span>add_cdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine add_cdata </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td></td></tr>
    <tr><td class="paramname">jp</td><td>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </td></tr>
    <tr><td class="paramname">j1</td><td>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </td></tr>
    <tr><td class="paramname">j2</td><td>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </td></tr>
    <tr><td class="paramname">j3</td><td>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </td></tr>
    <tr><td class="paramname">j4</td><td>add new data (C,j1,j2,j3,j4) to the list (ip:jp) in module cmdata </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaca8bcb501ac0147d13aa3bfbd9a5a934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca8bcb501ac0147d13aa3bfbd9a5a934">&#9670;&nbsp;</a></span>add_coef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine add_coef </td>
          <td>(</td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>j4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>@bsr_brief add new coefficient to the list in cmdata module </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae9d7256efddcadb09785f06f0b1b9431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9d7256efddcadb09785f06f0b1b9431">&#9670;&nbsp;</a></span>alloc_lcore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine alloc_lcore </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nbf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate (deallocate) arrays in module L_core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ks</td><td>allocate (deallocate) arrays in module L_core </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbf</td><td>allocate (deallocate) arrays in module L_core </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga08f4166bf9b9cd3735b9a7cfbce476e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga08f4166bf9b9cd3735b9a7cfbce476e0">&#9670;&nbsp;</a></span>alloc_zcore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine alloc_zcore </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nbf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate arrays in module Z_core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ks</td><td>allocate arrays in module Z_core </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbf</td><td>allocate arrays in module Z_core </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga021aa58b6d137adbbfe6ad8228ad87d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga021aa58b6d137adbbfe6ad8228ad87d0">&#9670;&nbsp;</a></span>allocate_cmdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine allocate_cmdata</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>allocate arrays in module cmdata</p>

</div>
</div>
<a id="ga78af874d39aa31ced6aff5f113b4bf94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78af874d39aa31ced6aff5f113b4bf94">&#9670;&nbsp;</a></span>allocate_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine allocate_matrix </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nch</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncp</td><td>allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mk</td><td>allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncfg</td><td>allocate arrays in module <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae8e42d9d606df9bcaecf1b767e5106b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae8e42d9d606df9bcaecf1b767e5106b5">&#9670;&nbsp;</a></span>allocate_ndefs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine allocate_ndefs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate arrays in module ndefs </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab18fa91f9ef0a4fa46223eb20984b401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab18fa91f9ef0a4fa46223eb20984b401">&#9670;&nbsp;</a></span>allocate_ndets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine allocate_ndets </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate arrays in module ndets </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab4b084bd6e249e6378845de9a56b81fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4b084bd6e249e6378845de9a56b81fd">&#9670;&nbsp;</a></span>bs_orth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bs_orth</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Including the orthogonal conditions for scattering orbitals by updating the interaction matrix according the procedure suggested by M.Bentley J.Phys.B27 (1994) 637.</p>
<p>Let i-th channel is supposed to be orthogonal to orbital p. It can be achieved by following modification of Hamiltonian: </p><pre class="fragment">       H --&gt;  (1 - Bcc') H (1 - cc'B) 
</pre><p>where c - full solution vector with all zero elements except the channel i is replaced on B-spline expansion of orbital p primes denote the transportasion.</p>
<p>It leads to transformation of separate blocks H(i,j):</p>
<p>H(i,j) with j &lt;&gt; i --&gt; (1 - Bpp') H(i,j) <br  />
 H(j,i) with j &lt;&gt; i --&gt; H(i,j) (1 - pp'B) <br  />
 H(i,i) with j = i --&gt; (1 - Bpp') H(i,j) (1 - pp'B) <br  />
 j also includes the block for interaction with perturbers</p>

</div>
</div>
<a id="ga0ab1de4a750178e1755ee67a80431932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ab1de4a750178e1755ee67a80431932">&#9670;&nbsp;</a></span>bsr_mat_inf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bsr_mat_inf</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>provide information about <a class="el" href="namespacebsr__mat.html">bsr_mat</a> program</p>

</div>
</div>
<a id="ga8005bfea023f4e763e7b1aec30de7cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8005bfea023f4e763e7b1aec30de7cee">&#9670;&nbsp;</a></span>check_det()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine check_det </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kdn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>N2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>expend the total overlap determinant so that to extract one-electron overlaps with continuum orbitals </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">kdn</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iext</td><td>expend the total overlap determinant so that to extract one-electron overlaps with continuum orbitals </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gae5f049653c4071f1926f39c91ead5168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5f049653c4071f1926f39c91ead5168">&#9670;&nbsp;</a></span>check_mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine check_mat </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>met</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the overlap matrix for big overlaps and assign new orthogonality conditions if needed </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">met</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga90c3451b67ceab57cb6bdea6dfd91f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90c3451b67ceab57cb6bdea6dfd91f60">&#9670;&nbsp;</a></span>det_fact()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine det_fact </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>IPN1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>IPN2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idf</td><td>Analize the determinant overlap factor. First each overlap determinant is expended into one-electron overlaps &lt;nl|n'l'&gt;, with overlaps included only known radial func. to be directly calculated. Results are places in module <a class="el" href="namespacenew__dets.html">new_dets</a>. Then overlap determinant are combined to obtain the final overlap factors as: C, C &lt;kl|nl&gt; or C &lt;kl|k'l'&gt;. Results are places in module <a class="el" href="namespacenew__defs.html">new_defs</a>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipn1</td><td>Analize the determinant overlap factor. First each overlap determinant is expended into one-electron overlaps &lt;nl|n'l'&gt;, with overlaps included only known radial func. to be directly calculated. Results are places in module <a class="el" href="namespacenew__dets.html">new_dets</a>. Then overlap determinant are combined to obtain the final overlap factors as: C, C &lt;kl|nl&gt; or C &lt;kl|k'l'&gt;. Results are places in module <a class="el" href="namespacenew__defs.html">new_defs</a>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipn2</td><td>Analize the determinant overlap factor. First each overlap determinant is expended into one-electron overlaps &lt;nl|n'l'&gt;, with overlaps included only known radial func. to be directly calculated. Results are places in module <a class="el" href="namespacenew__dets.html">new_dets</a>. Then overlap determinant are combined to obtain the final overlap factors as: C, C &lt;kl|nl&gt; or C &lt;kl|k'l'&gt;. Results are places in module <a class="el" href="namespacenew__defs.html">new_defs</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5e417b1eb2333d1787f33a4e54936605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e417b1eb2333d1787f33a4e54936605">&#9670;&nbsp;</a></span>f_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine f_values</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>define the f-values between target states based on the given asimptotic coefficients ACF for k=1</p>

</div>
</div>
<a id="ga56cddcf4108a3b0a144e49f655e70e4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56cddcf4108a3b0a144e49f655e70e4e">&#9670;&nbsp;</a></span>gen_lval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gen_lval</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate the L-integrals &lt;i|L|j&gt; and vectors &lt;.|L|j&gt;</p>

</div>
</div>
<a id="gaee20a200065c16a15bd939770e0b49dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee20a200065c16a15bd939770e0b49dd">&#9670;&nbsp;</a></span>gen_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gen_matrix </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jpol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>merge data and generate the interaction matrix for current itype </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jtype</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jpol</td><td>merge data and generate the interaction matrix for current itype </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gafe0b04565ad7519f523707bf01ff0eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe0b04565ad7519f523707bf01ff0eda">&#9670;&nbsp;</a></span>gen_zval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gen_zval</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates the Z-integrals and vectors</p>

</div>
</div>
<a id="ga4247a44666ad6f229792e15bb0dfa93c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4247a44666ad6f229792e15bb0dfa93c">&#9670;&nbsp;</a></span>gen_zzeta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gen_zzeta </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(ns,ks)&#160;</td>
          <td class="paramname"><em>rm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>izcorr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>B-spline matrix for Z*fine*1/r^3, Used for spin-orbit interaction; if izcorr &gt; 0, multiplied with correction r/(r+2*z*fine) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">izcorr</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga75783f72551fe654ab29d55bf336d369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75783f72551fe654ab29d55bf336d369">&#9670;&nbsp;</a></span>get_v()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_v </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ns)&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ii</td><td>provides &lt;.|nl&gt; for &lt;kl|nl&gt;; ii -&gt; kl; jj -&gt; nl; if &lt;kl|n'l'&gt; = 0 then nl -&gt; nl - &lt;nl|n'l'&gt; n'l'</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jj</td><td>provides &lt;.|nl&gt; for &lt;kl|nl&gt;; ii -&gt; kl; jj -&gt; nl; if &lt;kl|n'l'&gt; = 0 then nl -&gt; nl - &lt;nl|n'l'&gt; n'l' </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4884f97fcff28a8fb16a879d24722743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4884f97fcff28a8fb16a879d24722743">&#9670;&nbsp;</a></span>i_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine i_data </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jpol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>processing of I-integrals from the module 'cmdata'</p>
<p>we have following different structures:</p>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure 5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt; 9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic 13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 Rk * &lt; i | j &gt;  elements with i&lt;&gt;j are ignored becaUse
 we assume that target states diagonalize Hamiltonian
 These elements are included after in B(.,.) * Etarget(i)
 where B(.,.) is B-spline overlap matrix
 These elements are also Used for control calculation of 
 interaction matrix between target states (Target_h).

 sym_d -  symmetry for convolution
 sym_r -  symmetry for result

 jcase = 1 --&gt;  INT( . p1; . p2)
 jcase = 2 --&gt;  INT( p1 .;p2 . )
 jcase = 3 --&gt;  INT( . p1;p2 . )
 jcase = 4 --&gt;  INT( p1 .; . p2)
</pre>
</div>
</div>
<a id="ga264a971a9f0ec5398f4dc7ad48817982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga264a971a9f0ec5398f4dc7ad48817982">&#9670;&nbsp;</a></span>iadd_ndefs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine iadd_ndefs </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add new overlap factor if S &gt; Eps_det </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jo</td><td>add new overlap factor if S &gt; Eps_det </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga50885f1ee12bb74c53e7e1cc3d576806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50885f1ee12bb74c53e7e1cc3d576806">&#9670;&nbsp;</a></span>iadd_ndets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine iadd_ndets </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add new determinat overlap if S &gt; Eps_det </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jo</td><td>add new determinat overlap if S &gt; Eps_det </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2727469ba9e20d91a6158dc13880a30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2727469ba9e20d91a6158dc13880a30a">&#9670;&nbsp;</a></span>idef_itype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function idef_itype </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>k1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>k2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>k3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>k4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ibi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i3</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i4</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">io</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jo</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ic</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jc</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ibi</td><td><pre class="fragment"> we have following 16 different structures for radial integrals:
</pre></td></tr>
  </table>
  </dd>
</dl>
<p>1 1.0 Rk( . . . .) ic, jc - bound-bound <br  />
 2 1.1 Rk( . . . .) &lt; i | . &gt; ic - bound-channel 3 1.2 Rk( . . . .) &lt; i | . &gt; &lt; j | . &gt; - channel-channel 4 1.3 Rk( . . . .) &lt; i | j &gt; - target structure</p>
<p>5 2.0 Rk( i . . .) &lt; j | . &gt; - channel-channel due to 6 3.0 Rk( . i . .) &lt; j | . &gt; overlaps 7 4.0 Rk( . . i .) &lt; j | . &gt; 8 5.0 Rk( . . . i) &lt; j | . &gt;</p>
<p>9 2.1 Rk( i . . .) ic - bound-channel 10 3.1 Rk( . i . .) ic 11 4.1 Rk( . . i .) ic 12 5.1 Rk( . . . i) ic</p>
<p>13 6.0 Rk( i . j .) - direct channel-channel 14 7.0 Rk( . i . j) 15 8.0 Rk( i . . j) - exchange channel-channel 16 9.0 Rk( . i j .) </p><pre class="fragment"> where .  denotes bound orbital, i,j - channels.

 How it is packing:

                                    ibi         ibi
</pre><p> 1.0 Rk( . . . .) ic, jc - k1=(i1,i3) k2=(i2,i4) k3=-ic k4=-jc 1.1 Rk( . . . .) &lt; i | . &gt; ic - k1=(i1,i3) k2=(i2,i4) k3= io k4=-ic 1.2 Rk( . . . .) &lt;i|.&gt; &lt;j|.&gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= jo 1.3 Rk( . . . .) &lt; i | j &gt; - k1=(i1,i3) k2=(i2,i4) k3= io k4= 0</p>
<p>2.0 Rk( i . . .) &lt; j | . &gt; - k1=(i2,i4) k2=i3 k3=ich k4=io 3.0 Rk( . i . .) &lt; j | . &gt; - k1=(i1,i3) k2=i4 k3=ich k4=io 4.0 Rk( . . i .) &lt; j | . &gt; - k1=(i2,i4) k2=i1 k3=ich k4=io 5.0 Rk( . . . i) &lt; j | . &gt; - k1=(i1,i3) k2=i2 k3=ich k4=io</p>
<p>2.1 Rk( i . . .) ic - k1=(i2,i4) k2=i3 k3=ich k4=-ic 3.1 Rk( . i . .) ic - k1=(i1,i3) k2=i4 k3=ich k4=-ic <br  />
 4.1 Rk( . . i .) ic - k1=(i2,i4) k2=i1 k3=ich k4=-ic 5.1 Rk( . . . i) ic - k1=(i1,i3) k2=i2 k3=ich k4=-ic</p>
<p>6.0 Rk( i . j .) - k1=(ich1,ich2) k2=i2 k3=i4 k4=0 7.0 Rk( . i . j) - k1=(ich1,ich2) k2=i1 k3=i3 k4=0 8.0 Rk( i . . j) - k1=(ich1,ich2) k2=i2 k3=i3 k4=0 9.0 Rk( . i j .) - k1=(ich1,ich2) k2=i1 k3=i4 k4=0 </p>

</div>
</div>
<a id="ga609bbd7fa970c4d6290468a42a395906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga609bbd7fa970c4d6290468a42a395906">&#9670;&nbsp;</a></span>ifind_channel_serial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function ifind_channel_serial </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find channel (or perturber) for given configuration 'ic' </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ic</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5cd5a33848d99e56fd504fe053d3e5f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5cd5a33848d99e56fd504fe053d3e5f7">&#9670;&nbsp;</a></span>inf_bsr_mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine inf_bsr_mat</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>provide screen information about <a class="el" href="namespacebsr__mat.html">bsr_mat</a> program</p>

</div>
</div>
<a id="ga6262addd2372f5b910f065c5e9e2c9cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6262addd2372f5b910f065c5e9e2c9cb">&#9670;&nbsp;</a></span>initilize_cmdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine initilize_cmdata</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>clear the arrays from previous calculations</p>

</div>
</div>
<a id="ga49eb8485de3fa2b69600b916b3f294e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49eb8485de3fa2b69600b916b3f294e7">&#9670;&nbsp;</a></span>int_core()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine int_core </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generate B-spline representation for interaction with core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5dd32e07d22034a2568fd1356a9f0a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5dd32e07d22034a2568fd1356a9f0a80">&#9670;&nbsp;</a></span>intz_core()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine intz_core </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generate B-splne representation in array zl_core for Z-integrals with core interaction for given l </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaea49348f90e755d41a4720c7b4b925cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea49348f90e755d41a4720c7b4b925cd">&#9670;&nbsp;</a></span>jsym_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine jsym_int </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>met</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>use integral symmetry to obtaine the 'canonical' form</p>

</div>
</div>
<a id="ga31f955cb753cd82e1443578a0e05cf55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31f955cb753cd82e1443578a0e05cf55">&#9670;&nbsp;</a></span>l_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine l_data </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jtype</td><td>we have following different structures: <pre class="fragment"> L( . .)                        -  bound-bound
 L( i .)                        -  bound-channel
 L( . .) &lt; i | . &gt;              -  bound-channel
 L( i j)                        -  channel-channel
 L( i .) &lt; j | . &gt;              -  channel-channel
 L( . .) &lt; i | . &gt; &lt; j | . &gt;    -  channel-channel

 where .  denotes bound orbital, i,j - channels.

 L( . .) &lt; i | j &gt; elements with i/=j are ignored becaUse
 we assume that target states diagonalize Hamiltonian
 L( . .) &lt; i | i &gt; are included after in B(.,.) * Etarget(i)
 where B(.,.) is B-spline overlap matrix
 These elements are Used for control calculation of interaction
 matrix between target states (Target_h).
 L( i j) with with i/=j are also ignored becaUse we assume
 that target states are orthpgonal, but we have include
 interaction with core which is included in L(i,j)

 in int_bnk,  L(a,b) are represented as I(a,a;b,b)
</pre></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>we have following different structures: <pre class="fragment"> L( . .)                        -  bound-bound
 L( i .)                        -  bound-channel
 L( . .) &lt; i | . &gt;              -  bound-channel
 L( i j)                        -  channel-channel
 L( i .) &lt; j | . &gt;              -  channel-channel
 L( . .) &lt; i | . &gt; &lt; j | . &gt;    -  channel-channel

 where .  denotes bound orbital, i,j - channels.

 L( . .) &lt; i | j &gt; elements with i/=j are ignored becaUse
 we assume that target states diagonalize Hamiltonian
 L( . .) &lt; i | i &gt; are included after in B(.,.) * Etarget(i)
 where B(.,.) is B-spline overlap matrix
 These elements are Used for control calculation of interaction
 matrix between target states (Target_h).
 L( i j) with with i/=j are also ignored becaUse we assume
 that target states are orthpgonal, but we have include
 interaction with core which is included in L(i,j)

 in int_bnk,  L(a,b) are represented as I(a,a;b,b)
</pre> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gacb61b6365a22b464545b654107a56915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacb61b6365a22b464545b654107a56915">&#9670;&nbsp;</a></span>merge_cdata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine merge_cdata </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nn)&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nn)&#160;</td>
          <td class="paramname"><em>jp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8)&#160;</td>
          <td class="paramname"><em>eps_cc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nn</td><td>merge data from different blocks in MODULE 'cmdata'</td></tr>
  </table>
  </dd>
</dl>
<p>nn - number of blocks ip(.) - pointer for begining of block . jp(.) - pointer for end of block . nc - number of result coeff's eps_cc - all coefficients &lt; eps_cc are ignored</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nc</td><td>merge data from different blocks in MODULE 'cmdata'</td></tr>
  </table>
  </dd>
</dl>
<p>nn - number of blocks ip(.) - pointer for begining of block . jp(.) - pointer for end of block . nc - number of result coeff's eps_cc - all coefficients &lt; eps_cc are ignored </p>

</div>
</div>
<a id="gae9277a5b04cada2d259fa5990dd98d8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae9277a5b04cada2d259fa5990dd98d8f">&#9670;&nbsp;</a></span>mvcv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mvcv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ns,ks), intent(inout)&#160;</td>
          <td class="paramname"><em>vc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>Computes the matrix elements for the mass-velocity correction in the B-spline basis. The lack of symmetry in the d^2/dr^2 operator is ignored.</td></tr>
  </table>
  </dd>
</dl>
<p>VC(i,j) = INT [ (d^2/dr^2 - l(l+1)/r) B_i(r) * </p><h2>(d^2/dr^2 - l(l+1)/r) B_j(r) ] dr </h2>
<pre class="fragment"> on entry
 --------
   l    the angular momentum

 on exit
 -------
   vc   the mass velocity correction in symmetric storage mode
</pre> 
</div>
</div>
<a id="ga3361f70e89302ec2c692df11ae50028a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3361f70e89302ec2c692df11ae50028a">&#9670;&nbsp;</a></span>o_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine o_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>processing of total overlaps</p>
<p>possible structures:</p>
<p>c, (ic,jc) - bound-bound c &lt; i | . &gt;, ic - bound-channel c &lt; i | . &gt; &lt; j | . &gt; - channel-channel</p>
<p>where . denotes bound orbital, i,j - channels.</p>
<p>&lt; i | j &gt; elements are ignored becaUse we assume that target states are orthogonal. These elements are Used to check this orthogonality (see array 'to' in <a class="el" href="namespacebsr__matrix.html">bsr_matrix</a>).</p>

</div>
</div>
<a id="ga6046b07a0612b9253dbf40fa45cd7fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6046b07a0612b9253dbf40fa45cd7fa3">&#9670;&nbsp;</a></span>pri_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pri_int </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>icase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>i4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>print the integral for debug purposes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icase</td><td>print the integral for debug purposes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>print the integral for debug purposes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i1</td><td>print the integral for debug purposes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i2</td><td>print the integral for debug purposes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i3</td><td>print the integral for debug purposes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i4</td><td>print the integral for debug purposes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3e76be764ac0eec49ea1f658c431f0b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e76be764ac0eec49ea1f658c431f0b4">&#9670;&nbsp;</a></span>read_arg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_arg </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read input parameters </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga16b40b53422dc67fe65cf793458d956b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16b40b53422dc67fe65cf793458d956b">&#9670;&nbsp;</a></span>read_bsw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_bsw </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>read B-spline orbitals from bsw-file (unit nu) only for orbitals which are in the list "orb_LS"</p>

</div>
</div>
<a id="gae0e423f95e4e3d38efddcd41b370d0cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0e423f95e4e3d38efddcd41b370d0cd">&#9670;&nbsp;</a></span>read_conf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_conf </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nuc</td><td>Read the configuration list from c-file (unit 'nuc'), define the corresponding angular and configurational symmetries and compare with information from 'int_bnk' (unit 'nub')</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nub</td><td>Read the configuration list from c-file (unit 'nuc'), define the corresponding angular and configurational symmetries and compare with information from 'int_bnk' (unit 'nub') </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaae3f5c99fcf27fce39382bb506c6ca50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae3f5c99fcf27fce39382bb506c6ca50">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>read data for given partial wave, klsp</p>

</div>
</div>
<a id="ga022f005e9c5a726e0aafbfe841c8dbcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga022f005e9c5a726e0aafbfe841c8dbcb">&#9670;&nbsp;</a></span>read_dets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine read_dets</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>read the overlap determinants from INT_BNK (unit nub) <br  />
</p>

</div>
</div>
<a id="ga674f2cb9ac4e85268ece9a306f1f7965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga674f2cb9ac4e85268ece9a306f1f7965">&#9670;&nbsp;</a></span>record_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine record_matrix </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>record interaction (overlap) matrix to the unit 'nu' </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2f53371f0a86dae4b72d31aba3564bff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f53371f0a86dae4b72d31aba3564bff">&#9670;&nbsp;</a></span>reduce_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(8) function reduce_factor </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>define factor connecing reduced dipole matrix element with asymptotic coefficient for multipole index k </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>define factor connecing reduced dipole matrix element with asymptotic coefficient for multipole index k </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>define factor connecing reduced dipole matrix element with asymptotic coefficient for multipole index k </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7609207df74422f8b2758f1a48de118d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7609207df74422f8b2758f1a48de118d">&#9670;&nbsp;</a></span>shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine shift </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(out)&#160;</td>
          <td class="paramname"><em>N2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>array N2 obtained from array N1 by deleting element 'm' </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>array N2 obtained from array N1 by deleting element 'm' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n1</td><td>array N2 obtained from array N1 by deleting element 'm' </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaec39886073e72965c1d3b0438b03e243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaec39886073e72965c1d3b0438b03e243">&#9670;&nbsp;</a></span>state_res()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine state_res</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>extracts the data from int_bnk for specific case</p>

</div>
</div>
<a id="ga40c2d1441db2c6dbe37c5c433560f8c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40c2d1441db2c6dbe37c5c433560f8c7">&#9670;&nbsp;</a></span>sub1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine sub1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>provides calculations for one partial wave</p>

</div>
</div>
<a id="ga38c33a8251c1d7e2759702c9ebad6f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38c33a8251c1d7e2759702c9ebad6f06">&#9670;&nbsp;</a></span>target_h()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine target_h </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>CC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td>update target interaction and overlap matrixes, by considering the terms with structure &lt;kl|k'l&gt; &lt;target|H|target'&gt;</td></tr>
  </table>
  </dd>
</dl>
<p>It is not pure target states, but the basis states before |kl&gt;, i.e. the basis states may repeat, if one target state can couple to several kl.</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>update target interaction and overlap matrixes, by considering the terms with structure &lt;kl|k'l&gt; &lt;target|H|target'&gt;</td></tr>
  </table>
  </dd>
</dl>
<p>It is not pure target states, but the basis states before |kl&gt;, i.e. the basis states may repeat, if one target state can couple to several kl. </p>

</div>
</div>
<a id="ga3a63e173bdc2dbf0377b174dc162ef1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3a63e173bdc2dbf0377b174dc162ef1e">&#9670;&nbsp;</a></span>target_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine target_new</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>new target energies</p>

</div>
</div>
<a id="gae18d8db1b226e35e6280aff288338a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae18d8db1b226e35e6280aff288338a80">&#9670;&nbsp;</a></span>target_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine target_print </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>EC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>eps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>prints target info </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iout</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1b5b0c928f5bd0959e03c3d23f136fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1b5b0c928f5bd0959e03c3d23f136fe5">&#9670;&nbsp;</a></span>update_cf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_cf </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update asymptotic coefficients. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td>Update asymptotic coefficients </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>Update asymptotic coefficients </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac9cf44c0c9fc5ad2dd435599ea85f4fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9cf44c0c9fc5ad2dd435599ea85f4fc">&#9670;&nbsp;</a></span>update_hb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_hb </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update scalar in the bound-bound block </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ic</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jc</td><td>update scalar in the bound-bound block </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7677a4f429f4e454fa43e7daf2b0d918"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7677a4f429f4e454fa43e7daf2b0d918">&#9670;&nbsp;</a></span>update_hl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_hl </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ns,ks), intent(in)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update symmetric banded matrix in lower-column storage mode ! </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>update symmetric banded matrix in lower-column storage mode ! </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>update symmetric banded matrix in lower-column storage mode ! </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ks</td><td>update symmetric banded matrix in lower-column storage mode ! </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga579285c9aa90774a8452e7d02f54507d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga579285c9aa90774a8452e7d02f54507d">&#9670;&nbsp;</a></span>update_hv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_hv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), intent(in)&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update vector in the channel-bound block </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ic</td><td>update vector in the channel-bound block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>update vector in the channel-bound block </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaa8bf8509f43227d5f00d3d0f423939f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa8bf8509f43227d5f00d3d0f423939f">&#9670;&nbsp;</a></span>update_hw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_hw </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update channel block with by v*w </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>update channel block with by v*w </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>update channel block with by v*w </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8ec3b742ec7541197da9e9a49bb7c3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ec3b742ec7541197da9e9a49bb7c3b7">&#9670;&nbsp;</a></span>update_hx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine update_hx </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ich</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(ns,*), intent(in)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(1), intent(in)&#160;</td>
          <td class="paramname"><em>sym</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update channel block </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ich</td><td><pre class="fragment">sym = 's'  --&gt;  symmetric banded upper-column storage mode
sym = 'n'  --&gt;  non-symmetric band matrix  
sym = 'x'  --&gt;  non-symmetric full matrix
</pre> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jch</td><td>update channel block <pre class="fragment">sym = 's'  --&gt;  symmetric banded upper-column storage mode
sym = 'n'  --&gt;  non-symmetric band matrix  
sym = 'x'  --&gt;  non-symmetric full matrix
</pre> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ns</td><td>update channel block <pre class="fragment">sym = 's'  --&gt;  symmetric banded upper-column storage mode
sym = 'n'  --&gt;  non-symmetric band matrix  
sym = 'x'  --&gt;  non-symmetric full matrix
</pre> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ks</td><td>update channel block <pre class="fragment">sym = 's'  --&gt;  symmetric banded upper-column storage mode
sym = 'n'  --&gt;  non-symmetric band matrix  
sym = 'x'  --&gt;  non-symmetric full matrix
</pre> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa5916f9f05e8e66f538f9a4196d13af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5916f9f05e8e66f538f9a4196d13af1">&#9670;&nbsp;</a></span>vdet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(8) function vdet </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(kd), intent(in)&#160;</td>
          <td class="paramname"><em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(kd), intent(in)&#160;</td>
          <td class="paramname"><em>N2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the value of overlap determinant for given orbitals Calls: DET </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">kd</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n1</td><td>calculate the value of overlap determinant for given orbitals Calls: DET </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n2</td><td>calculate the value of overlap determinant for given orbitals Calls: DET </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga86aad19d1517654fef57ae806dbf8927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga86aad19d1517654fef57ae806dbf8927">&#9670;&nbsp;</a></span>z_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine z_data </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jtype</td><td>we have following different structures: <pre class="fragment"> Z( . .)                        -  bound-bound
 Z( i .)                        -  bound-channel
 Z( . .) &lt; i | . &gt;              -  bound-channel
 Z( i i)                        -  channel-channel
 Z( i .) &lt; j | . &gt;              -  channel-channel
 Z( . .) &lt; i | . &gt; &lt; j | . &gt;    -  channel-channel

 where .  denotes bound orbital, i,j - channels.
</pre></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>we have following different structures: <pre class="fragment"> Z( . .)                        -  bound-bound
 Z( i .)                        -  bound-channel
 Z( . .) &lt; i | . &gt;              -  bound-channel
 Z( i i)                        -  channel-channel
 Z( i .) &lt; j | . &gt;              -  channel-channel
 Z( . .) &lt; i | . &gt; &lt; j | . &gt;    -  channel-channel

 where .  denotes bound orbital, i,j - channels.
</pre> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gaf3e82e5aaa6dbd55b62a26d696f5ddc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf3e82e5aaa6dbd55b62a26d696f5ddc9">&#9670;&nbsp;</a></span>kch</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer bsr_matrix::kch</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">contains the basic matrices:

hcc  -  interaction (or overlap) chanel-channel matrix
hcb  -  interaction (or overlap) chanel-bound matrix
hbb  -  interaction (or overlap) bound-bound matrix
ACF  -  array of asymptotic coefficients
htarg  -  interaction matrix for target states
otarg  -  overlap matrix for target states
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td>of channels </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga9e6abf295659518186a90e82f5225f75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e6abf295659518186a90e82f5225f75">&#9670;&nbsp;</a></span>lh_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer l_core::lh_dir</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>contain B-spline representation for L-integral including the interaction with common core </p>
<p>hl(ns,ks) - matrix of L-operator in the B-splne basis (in symmetric lower-column mode)</p>
<p>hl_dir(ns,ks) - direct interaction with core (in symmetric upper-column mode)</p>
<p>hl and hl_dir have different representation !!!</p>
<p>lh_dir = [-1|1] - (not|yes) shows if hl_dir is done or no (this parameter allows us to compute the hl_dir only once because hl and hl_dir does not depend on l)</p>
<p>hl_exc(ns,ns) - exchange interaction with core</p>
<p>hl_core(ns,ns) - final hl-matrix with core interaction included (in full representation)</p>
<p>mlh - max. l-value</p>
<p>hl_full(ns,ns,mlh) - all L-matreces</p>
<p>vc(ns,ks) - relativistic mass-velocity correction </p>

</div>
</div>
<a id="ga1307721a915029971f2d37812bc53c39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1307721a915029971f2d37812bc53c39">&#9670;&nbsp;</a></span>lz_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer z_core::lz_dir</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>contains B-splne representation for Z-integral including the interaction with core </p>
<p>zl(ns,ks) - matrix of Z-operator in the B-splne basis (in symmetric lower-column mode)</p>
<p>zl_dir(ns,ks) - direct interaction with core (in symmetric upper-column mode)</p>
<p>zl and zl_dir have different representation !!!</p>
<p>lz_dir = [-1|1] - (not|yes) for Done of zl_dir (this parameter allows us to compute the zl_dir only once because zl_dir does not depend on l)</p>
<p>zl_exc(ns,ns) - exchange interaction with core</p>
<p>zl_core(ns,ns) - final zl with core interaction (in full representation)</p>
<p>mlz - max. l for so-interaction</p>
<p>zl_full(ns,ns,mlz) - all z-matreces</p>
<p>Z_int - Z-integrals &lt;P_i| Z |P_j&gt;</p>
<p>Z_vec - vectors &lt; . | Z | P_i&gt;</p>
<p>d,x - auxiliary arrays </p>

</div>
</div>
<a id="gac8b59f259bef35dc4d68f1cb8102ca76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac8b59f259bef35dc4d68f1cb8102ca76">&#9670;&nbsp;</a></span>ma</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer parameter bsr_mat::ma =20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main parameters for the BSR_MAT program </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
