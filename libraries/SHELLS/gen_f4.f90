!=======================================================================
  Real(8) Function gen_f4 (ip,id)
!=======================================================================
!
! contains f4-shell cfp coefficients as  sqrt(m1/m2) 
!
! ip - index of parent term
! id - index of daughter term
!
!-----------------------------------------------------------------------
 
  Implicit none
 
  Integer, parameter :: nd =   47  ! number of daughter terms
  Integer, parameter :: np =   17  ! number of parent terms
  Integer, parameter :: ng =  367  ! number of non-zero cfp's
 
  Integer(2) :: ind(0:nd)
  Integer(1) :: ipa(ng)
  Integer(4) :: m1(ng)
  Integer(4) :: m2(ng)
 
  Integer :: ip,id,i
 
  if(id.le.0) Stop "gen_f4: id < 0"
  if(ip.le.0) Stop "gen_f4: ip < 0"
  if(id.gt.nd) Stop "gen_f4: id > nd"
  if(ip.gt.np) Stop "gen_f4: ip > np"
 
  gen_f4 = 0.d0
  Do i=ind(id-1)+1,ind(id)
   if(ip.ne.ipa(i)) Cycle
   gen_f4 = sqrt(abs(DBLE(m1(i)))/DBLE(m2(i)))
   if(m1(i).lt.0) gen_f4 = -gen_f4
   Exit
  End Do
 
  Data ind/  &
    0,    1,    4,    9,   13,   16,   25,   33,   40,   51,   61,   72, &
   82,   93,  102,  116,  129,  140,  154,  167,  179,  191,  202,  211, &
  220,  228,  234,  238,  239,  240,  249,  257,  265,  269,  277,  288, &
  298,  308,  313,  322,  328,  337,  345,  350,  357,  362,  365,  367  /
 
 
  Data ipa/  &
  3,  2,  3,  4,  1,  2,  3,  4,  5,  2,  3,  4,  5,  3,  4,  5,  2,  3, &
  4,  7,  8,  9, 10, 11, 12,  2,  3,  4,  7,  8, 10, 11, 12,  2,  4,  7, &
  8, 10, 11, 12,  2,  3,  4,  6,  7,  8, 10, 11, 12, 13, 14,  2,  4,  6, &
  7,  8, 10, 11, 12, 13, 14,  1,  2,  3,  4,  5,  6,  7,  9, 11, 13, 15, &
  1,  2,  3,  4,  5,  6,  7, 11, 13, 15,  2,  4,  5,  6,  7,  8, 10, 11, &
 12, 13, 15,  2,  4,  5,  7,  8, 11, 12, 14, 15,  2,  3,  4,  5,  6,  7, &
  8, 10, 11, 12, 13, 14, 15, 16,  2,  4,  5,  6,  7,  8, 10, 11, 12, 13, &
 14, 15, 16,  2,  4,  5,  7,  8, 10, 11, 12, 14, 15, 16,  2,  3,  4,  5, &
  7,  8,  9, 10, 11, 12, 14, 15, 16, 17,  2,  3,  4,  5,  7,  8, 10, 11, &
 12, 14, 15, 16, 17,  2,  4,  5,  7,  8, 11, 12, 13, 14, 15, 16, 17,  2, &
  4,  5,  7,  8, 10, 11, 12, 14, 15, 16, 17,  3,  4,  5, 10, 11, 12, 13, &
 14, 15, 16, 17,  4,  5, 10, 11, 12, 14, 15, 16, 17,  4,  5, 11, 12, 13, &
 14, 15, 16, 17,  4,  5, 11, 12, 14, 15, 16, 17,  5, 13, 14, 15, 16, 17, &
  5, 15, 16, 17,  9, 10,  6,  7,  8,  9, 10, 11, 12, 13, 14,  6,  7,  8, &
 10, 11, 12, 13, 14,  6,  7,  8, 10, 11, 12, 13, 14,  8, 10, 12, 14,  6, &
  7,  8, 10, 11, 12, 13, 15,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, &
  6,  7,  8, 10, 11, 12, 13, 14, 15, 16,  6,  7,  8, 10, 11, 12, 13, 14, &
 15, 16,  8, 10, 12, 14, 16,  7,  8, 11, 12, 13, 14, 15, 16, 17,  8, 10, &
 12, 14, 16, 17,  9, 10, 11, 12, 13, 14, 15, 16, 17, 10, 11, 12, 13, 14, &
 15, 16, 17, 10, 12, 14, 16, 17, 11, 12, 13, 14, 15, 16, 17, 13, 14, 15, &
 16, 17, 14, 16, 17, 16, 17  /
 
 
  Data m1/  &
       -1,       -2,       -1,       33,        1,        5,        3, &
        9,       13,       55,       -1,     -125,       91,       -1, &
       21,        7,       -1,       -1,       11,       -1,      -11, &
        5,       11,       11,       39,        1,       -3,      -11, &
      128,      -11,       11,     -704,       39,      -11,      -10, &
       22,      289,       -5,       20,      429,        2,       -7, &
      -11,       -6,      -64,      -99,      -11,       44,      -39, &
      -44,      143,      -11,      -16,      -11,     -275,       75, &
        1,      -50,     -143,       27,       39,        1,       -2, &
        2,       -2,      -26,       -3,        1,        5,        1, &
      -11,       13,       -9,        1,        3,        1,       13, &
       -3,       -4,       -4,      -11,      -52,       55,        8, &
      -91,      -11,     1375,       -5,        1,       25,      -65, &
        3,     -325,     -143,      130,      -35,      143,      -39, &
     -260,        6,        1,        5,      -55,       -7,      125, &
      -13,       11,      220,      -20,       -2,     -500,      -26, &
      -65,       -4,       52,       20,      -13,     -104,       -5, &
       65,     -325,     -143,       65,     -325,     5819,       33, &
      -44,     -125,        4,      -11,       -2,       65,       11, &
       25,       35,        4,      -13,        7,      -65,        9, &
       -2,       -1,      -13,       91,       -1,       27,        5, &
       -3,      -13,       27,       -1,       13,       -3,       17, &
        2,       -3,       13,      -91,      256,       27,       -3, &
      832,       27,       -1,    -1664,       -3,       17,      -13, &
       16,       10,     -325,      -39,       50,       12,        1, &
     -289,      125,       33,       85,      -26,       -6,      -35, &
       52,     -325,      -65,       12,      361,      243,       10, &
        1,      255,       -7,       -1,       -1,        7,        4, &
      -15,        2,       -5,       32,     -255,      -51,       -8, &
        1,        7,       16,      125,       15,       -2,     2125, &
     -153,      -16,       17,      -50,      -12,        1,      121, &
      425,      -17,      323,      -17,      -16,       34,      -51, &
      -34,       32,      121,       19,       -1,        1,       -5, &
      -25,     -285,       19,       -1,        2,      -15,       -7, &
        1,        1,        3,       12,      -99,        5,      -11, &
      -99,      -39,       11,      143,      -72,      256,      297, &
       11,     -528,      117,     -176,     -143,       11,      891, &
       75,        1,       54,     -143,      -27,       39,      -13, &
       39,      297,        9,       11,     -165,       -5,        1, &
      -27,      -65,       -3,       39,      -11,      -11,       -4, &
        5,       -2,       75,      -26,       13,       -4,      -13, &
        4,       44,     -176,        1,        1,      400,       39, &
      -52,        1,     -208,       -1,      -65,       39,     -143, &
       65,      117,     5819,      -33,      -44,       15,        4, &
       13,       65,       -1,     -361,      -49,       13,      -39, &
      -18,       12,       -1,     -289,       -5,       33,       85, &
        7,      -35,        7,       -3,        7,     -255,        5, &
       49,       -9,       -3,       -7,       -1,       -6,      -51, &
      -51,       -7,      -48,        9,        8,        1,     -128, &
      153,      153,       85,      833,      -51,    -2401,       45, &
       18,      -12,       -1,      121,     -153,      -17,      323, &
       -1,       -5,       27,     -285,       19,       38,      -21, &
       -5,       -5,       11  /
 
 
  Data m2/  &
        1,        7,        8,       56,        7,       56,        8, &
       56,       56,      168,        8,      616,      264,        8, &
       88,       11,        7,       30,       70,       98,      294, &
       12,      120,      980,      392,       63,       10,      630, &
      441,     1176,      480,     2205,     1568,       63,       63, &
      441,     1176,       96,      441,     1568,      147,       24, &
      392,       49,     1029,     1372,      168,      343,    13720, &
      441,     1260,       49,      147,      196,     2744,     2744, &
        7,     1029,     1715,      392,      280,       35,       63, &
       15,       35,      315,      140,       36,       12,       20, &
      140,      180,       35,     4536,       40,     2520,    22680, &
       35,       81,       45,       35,      405,      378,      231, &
      594,      112,    21168,       49,        8,     1617,      392, &
      112,     4752,     1134,      693,     1782,     3969,      196, &
     4851,       49,        4,      891,     3528,       24,    12936, &
      792,      147,     3087,     1029,      231,    11319,      343, &
      441,       63,      693,      231,     2646,      441,       54, &
      784,   148176,     3087,      504,     3087,    41160,      784, &
     1365,     3024,       91,       54,       99,      594,      189, &
      252,      198,      693,      210,       60,     2079,       77, &
       63,       30,      154,      495,      441,     2156,       12, &
      440,     2156,     1960,       20,      990,       44,      220, &
      567,       10,     1386,     4455,     3969,     8624,     1760, &
     4851,     7840,       80,     4455,      176,      880,       81, &
       99,      891,     4536,      616,      693,      455,        8, &
     3640,    24948,      182,     2002,      189,       77,      297, &
     1323,     8624,      352,      539,   101920,     1040,      297, &
     2288,     2288,       24,       88,       33,      264,       77, &
      728,        9,     1638,      231,     4004,      364,       33, &
       11,       88,      231,      728,      182,       77,    16016, &
     1456,       99,       99,      693,      455,        8,      910, &
     5544,     1456,     1456,       99,       99,      693,      455, &
      455,      693,      364,      364,        3,        8,      182, &
      168,     1456,      112,        3,       21,      112,       16, &
        1,        1,       70,      245,      980,       12,      120, &
      980,     9800,      315,      900,      245,     1715,   109760, &
     4480,     1715,  1097600,      735,    33600,      196,     2744, &
     2744,        7,      343,     1715,      392,      280,       64, &
      128,      640,      320,      112,      784,       49,        8, &
      539,      392,      112,      176,      420,      196,      147, &
       12,      165,     2156,      245,      252,       45,      220, &
       33,      245,     1029,     1372,     3080,     3773,    13720, &
      147,      420,     1155,      308,      784,     5488,     3087, &
      504,      343,    41160,      784,     1365,      112,       91, &
       36,      792,      120,      780,      572,       56,      616, &
       77,      455,        8,     3640,      308,      182,     2002, &
       44,       88,       40,      140,      176,     1232,       12, &
     1320,      220,      104,       90,      234,       55,      572, &
      260,     7040,      385,    11648,       15,     8736,      385, &
    64064,    29120,     1408,     1664,      416,     9152,      832, &
       77,      455,        8,      910,      616,     1456,     1456, &
        8,      182,       56,     1456,      112,       91,       52, &
       28,       16,       16  /
 
  End Function gen_f4
