!======================================================================
      Module det_jq
!======================================================================
!     contains data for expanding the j^q subshell wave function 
!     over deterninant w.f.
!
!     Idet_jq  - identifier of subshell detetrminant w.f. as list of 
!                the one-electron lsm-orbitals according to the common
!                list (-1/2, 1/2, -3/2, 3/2, ...)
!     MD_jq    - list of the correspondent total magnetic quantum numbers
!
!     Expansion coefficient for given determinant 'id' and term 'it'
!     is presented as  sqrt [ ID_jq(id,it) / JD_jq(id,it) ].
!
!     Routines: 
!
!     DET_sh_jq (j,q,id,MJ,Idet) - gives the determinant 'id' and total MJ 
!                                  for the subshell j^q
!
!     DETC_jq (j,q,it,id) - gives the expansion coefficient 
!                           for the subshell 'jq', term 'it' and determinant 'id'
!----------------------------------------------------------------------
      Implicit none

! ... subshell [1/2]^2

      Integer, parameter :: kd_j1_q2 =  1
      Integer, parameter :: nt_j1_q2 =  1
      Integer :: Idet_j1_q2(2,kd_j1_q2)
      Integer :: MD_j1_q2(kd_j1_q2)
      Integer :: ID_j1_q2(nt_j1_q2,kd_j1_q2)
      Integer :: JD_j1_q2(nt_j1_q2,kd_j1_q2)

      Data Idet_j1_q2/ &
          1,    2  /
      Data MD_j1_q2/ &
          0  /
      Data ID_j1_q2/ &
         -1  /
      Data JD_j1_q2/ &
          1  /

! ... subshell [3/2]^2

      Integer, parameter :: kd_j3_q2 =  6
      Integer, parameter :: nt_j3_q2 =  2
      Integer :: Idet_j3_q2(2,kd_j3_q2)
      Integer :: MD_j3_q2(kd_j3_q2)
      Integer :: ID_j3_q2(nt_j3_q2,kd_j3_q2)
      Integer :: JD_j3_q2(nt_j3_q2,kd_j3_q2)

      Data Idet_j3_q2/ &
          1,    2, &
          1,    3, &
          1,    4, &
          2,    3, &
          2,    4, &
          3,    4  /
      Data MD_j3_q2/ &
          0,   -4,    2,   -2,    4,    0  /
      Data ID_j3_q2/ &
          1,   -1, &
          0,    1, &
          0,   -1, &
          0,    1, &
          0,   -1, &
         -1,   -1  /
      Data JD_j3_q2/ &
          2,    2, &
          1,    1, &
          1,    1, &
          1,    1, &
          1,    1, &
          2,    2  /

! ... subshell [3/2]^3

      Integer, parameter :: kd_j3_q3 =  4
      Integer, parameter :: nt_j3_q3 =  1
      Integer :: Idet_j3_q3(3,kd_j3_q3)
      Integer :: MD_j3_q3(kd_j3_q3)
      Integer :: ID_j3_q3(nt_j3_q3,kd_j3_q3)
      Integer :: JD_j3_q3(nt_j3_q3,kd_j3_q3)

      Data Idet_j3_q3/ &
          1,    2,    3, &
          1,    2,    4, &
          1,    3,    4, &
          2,    3,    4  /
      Data MD_j3_q3/ &
         -3,    3,   -1,    1  /
      Data ID_j3_q3/ &
          1, &
          1, &
         -1, &
         -1  /
      Data JD_j3_q3/ &
          1, &
          1, &
          1, &
          1  /
! ... subshell [3/2]^4

      Integer, parameter :: kd_j3_q4 =  1
      Integer, parameter :: nt_j3_q4 =  1
      Integer :: Idet_j3_q4(4,kd_j3_q4)
      Integer :: MD_j3_q4(kd_j3_q4)
      Integer :: ID_j3_q4(nt_j3_q4,kd_j3_q4)
      Integer :: JD_j3_q4(nt_j3_q4,kd_j3_q4)

      Data Idet_j3_q4/ &
          1,    2,    3,    4  /

      Data MD_j3_q4/ &
          0  /

      Data ID_j3_q4/ &
         -1  /

      Data JD_j3_q4/ &
          1  /

! ... subshell [5/2]^2

      Integer, parameter :: kd_j5_q2 = 15
      Integer, parameter :: nt_j5_q2 =  3
 
      Integer :: Idet_j5_q2(2,kd_j5_q2)
      Integer :: MD_j5_q2(kd_j5_q2)
      Integer :: ID_j5_q2(nt_j5_q2,kd_j5_q2)
      Integer :: JD_j5_q2(nt_j5_q2,kd_j5_q2)

      Data Idet_j5_q2/ &
          1,    2, &
          1,    3, &
          1,    4, &
          1,    5, &
          1,    6, &
          2,    3, &
          2,    4, &
          2,    5, &
          2,    6, &
          3,    4, &
          3,    5, &
          3,    6, &
          4,    5, &
          4,    6, &
          5,    6  /

      Data MD_j5_q2/ &
          0,   -4,    2,   -6,    4,   -2,    4,   -4,    6,    0, &
         -8,    2,   -2,    8,    0  /

      Data ID_j5_q2/ &
         -1,    8,   -2, &
          0,   -9,    5, &
          0,    2,   -5, &
          0,    0,    1, &
          0,   -5,   -9, &
          0,   -2,    5, &
          0,    9,   -5, &
          0,    5,    9, &
          0,    0,   -1, &
          1,   -1,   -9, &
          0,    0,    1, &
          0,   -5,   -2, &
          0,    5,    2, &
          0,    0,   -1, &
         -1,  -25,   -1  /

      Data JD_j5_q2/ &
          3,   21,    7, &
          1,   14,   14, &
          1,    7,    7, &
          1,    1,    1, &
          1,   14,   14, &
          1,    7,    7, &
          1,   14,   14, &
          1,   14,   14, &
          1,    1,    1, &
          3,   42,   14, &
          1,    1,    1, &
          1,    7,    7, &
          1,    7,    7, &
          1,    1,    1, &
          3,   42,   14  /

! ... subshell [5/2]^3

      Integer, parameter :: kd_j5_q3 = 20
      Integer, parameter :: nt_j5_q3 =  3
 
      Integer :: Idet_j5_q3(3,kd_j5_q3)
      Integer :: MD_j5_q3(kd_j5_q3)
      Integer :: ID_j5_q3(nt_j5_q3,kd_j5_q3)
      Integer :: JD_j5_q3(nt_j5_q3,kd_j5_q3)

      Data Idet_j5_q3/ &
          1,    2,    3, &
          1,    2,    4, &
          1,    2,    5, &
          1,    2,    6, &
          1,    3,    4, &
          1,    3,    5, &
          1,    3,    6, &
          1,    4,    5, &
          1,    4,    6, &
          1,    5,    6, &
          2,    3,    4, &
          2,    3,    5, &
          2,    3,    6, &
          2,    4,    5, &
          2,    4,    6, &
          2,    5,    6, &
          3,    4,    5, &
          3,    4,    6, &
          3,    5,    6, &
          4,    5,    6  /

      Data MD_j5_q3/ &
         -3,    3,   -5,    5,   -1,   -9,    1,   -3,    7,   -1, &
          1,   -7,    3,   -1,    9,    1,   -5,    5,   -3,    3  /

      Data ID_j5_q3/ &
          1,    8,    5, &
          1,   -8,    5, &
          1,    0,    1, &
          1,    0,    1, &
         -1,   -1,   -5, &
          0,    0,   -1, &
          0,   -5,   -2, &
          0,   -5,   16, &
          0,    0,    1, &
          1,   -1,   -5, &
         -1,    1,   -5, &
          0,    0,   -1, &
          0,   -5,  -16, &
          0,   -5,    2, &
          0,    0,    1, &
          1,    1,   -5, &
         -1,    0,    1, &
         -1,    0,    1, &
          1,   -8,   -5, &
          1,    8,   -5  /

      Data JD_j5_q3/ &
          2,   21,   42, &
          2,   21,   42, &
          2,    1,    2, &
          2,    1,    2, &
          2,    7,   14, &
          1,    1,    1, &
          1,    7,    7, &
          1,   21,   21, &
          1,    1,    1, &
          2,    7,   14, &
          2,    7,   14, &
          1,    1,    1, &
          1,   21,   21, &
          1,    7,    7, &
          1,    1,    1, &
          2,    7,   14, &
          2,    1,    2, &
          2,    1,    2, &
          2,   21,   42, &
          2,   21,   42  /

! ... subshell [5/2]^4

      Integer, parameter :: kd_j5_q4 = 15
      Integer, parameter :: nt_j5_q4 =  3
 
      Integer :: Idet_j5_q4(4,kd_j5_q4)
      Integer :: MD_j5_q4(kd_j5_q4)
      Integer :: ID_j5_q4(nt_j5_q4,kd_j5_q4)
      Integer :: JD_j5_q4(nt_j5_q4,kd_j5_q4)

      Data Idet_j5_q4/ &
          1,    2,    3,    4, &
          1,    2,    3,    5, &
          1,    2,    3,    6, &
          1,    2,    4,    5, &
          1,    2,    4,    6, &
          1,    2,    5,    6, &
          1,    3,    4,    5, &
          1,    3,    4,    6, &
          1,    3,    5,    6, &
          1,    4,    5,    6, &
          2,    3,    4,    5, &
          2,    3,    4,    6, &
          2,    3,    5,    6, &
          2,    4,    5,    6, &
          3,    4,    5,    6  /

      Data MD_j5_q4/ &
          0,   -8,    2,   -2,    8,    0,   -6,    4,   -4,    2, &
         -4,    6,   -2,    4,    0  /

      Data ID_j5_q4/ &
          1,  -25,   -1, &
          0,    0,    1, &
          0,   -5,   -2, &
          0,    5,    2, &
          0,    0,   -1, &
         -1,   -1,   -9, &
          0,    0,   -1, &
          0,    5,    9, &
          0,   -9,    5, &
          0,    2,   -5, &
          0,   -5,   -9, &
          0,    0,    1, &
          0,   -2,    5, &
          0,    9,   -5, &
          1,    8,   -2  /

      Data JD_j5_q4/ &
          3,   42,   14, &
          1,    1,    1, &
          1,    7,    7, &
          1,    7,    7, &
          1,    1,    1, &
          3,   42,   14, &
          1,    1,    1, &
          1,   14,   14, &
          1,   14,   14, &
          1,    7,    7, &
          1,   14,   14, &
          1,    1,    1, &
          1,    7,    7, &
          1,   14,   14, &
          3,   21,    7  /

! ... subshell [5/2]^5

      Integer, parameter :: kd_j5_q5 =  6
      Integer, parameter :: nt_j5_q5 =  1
 
      Integer :: Idet_j5_q5(5,kd_j5_q5)
      Integer :: MD_j5_q5(kd_j5_q5)
      Integer :: ID_j5_q5(nt_j5_q5,kd_j5_q5)
      Integer :: JD_j5_q5(nt_j5_q5,kd_j5_q5)

      Data Idet_j5_q5/ &
          1,    2,    3,    4,    5, &
          1,    2,    3,    4,    6, &
          1,    2,    3,    5,    6, &
          1,    2,    4,    5,    6, &
          1,    3,    4,    5,    6, &
          2,    3,    4,    5,    6  /

      Data MD_j5_q5/ &
         -5,    5,   -3,    3,   -1,    1  /

      Data ID_j5_q5/ &
         -1, &
         -1, &
          1, &
          1, &
         -1, &
         -1  /

      Data JD_j5_q5/ &
          1, &
          1, &
          1, &
          1, &
          1, &
          1  /

! ... subshell [5/2]^6

      Integer, parameter :: kd_j5_q6 =  1
      Integer, parameter :: nt_j5_q6 =  1
 
      Integer :: Idet_j5_q6(6,kd_j5_q6)
      Integer :: MD_j5_q6(kd_j5_q6)
      Integer :: ID_j5_q6(nt_j5_q6,kd_j5_q6)
      Integer :: JD_j5_q6(nt_j5_q6,kd_j5_q6)

      Data Idet_j5_q6/ &
          1,    2,    3,    4,    5,    6  /

      Data MD_j5_q6/ &
          0  /

      Data ID_j5_q6/ &
          1  /

      Data JD_j5_q6/ &
          1  /

! ... subshell [7/2]^2

      Integer, parameter :: kd_j7_q2 = 28
      Integer, parameter :: nt_j7_q2 =  4
 
      Integer :: Idet_j7_q2(2,kd_j7_q2)
      Integer :: MD_j7_q2(kd_j7_q2)
      Integer :: ID_j7_q2(nt_j7_q2,kd_j7_q2)
      Integer :: JD_j7_q2(nt_j7_q2,kd_j7_q2)

      Data Idet_j7_q2/ &
          1,    2, &
          1,    3, &
          1,    4, &
          1,    5, &
          1,    6, &
          1,    7, &
          1,    8, &
          2,    3, &
          2,    4, &
          2,    5, &
          2,    6, &
          2,    7, &
          2,    8, &
          3,    4, &
          3,    5, &
          3,    6, &
          3,    7, &
          3,    8, &
          4,    5, &
          4,    6, &
          4,    7, &
          4,    8, &
          5,    6, &
          5,    7, &
          5,    8, &
          6,    7, &
          6,    8, &
          7,    8  /

      Data MD_j7_q2/ &
          0,   -4,    2,   -6,    4,   -8,    6,   -2,    4,   -4, &
          6,   -6,    8,    0,   -8,    2,  -10,    4,   -2,    8, &
         -4,   10,    0,  -12,    2,   -2,   12,    0  /

      Data ID_j7_q2/ &
          1,  -25,   81,  -25, &
          0,   10,  -24,    7, &
          0,   -5,   27,  -35, &
          0,    0,   -4,    7, &
          0,    5,    1,   -7, &
          0,    0,    7,   15, &
          0,    0,   -7,   -4, &
          0,    5,  -27,   35, &
          0,  -10,   24,   -7, &
          0,   -5,   -1,    7, &
          0,    0,    4,   -7, &
          0,    0,    7,    4, &
          0,    0,   -7,  -15, &
         -1,    3,    9,  -27, &
          0,    0,  -15,    7, &
          0,    8,  -15,  -14, &
          0,    0,    0,    1, &
          0,   -1,  -15,   -5, &
          0,   -8,   15,   14, &
          0,    0,   15,   -7, &
          0,    1,   15,    5, &
          0,    0,    0,   -1, &
          1,    1, -169,  -25, &
          0,    0,    0,    1, &
          0,   -1,   -5,   -1, &
          0,    1,    5,    1, &
          0,    0,    0,   -1, &
         -1,   -7,   -7,   -1  /

      Data JD_j7_q2/ &
          4,   84,  308,  132, &
          1,   21,   77,   33, &
          1,   42,   77,   66, &
          1,    1,   11,   11, &
          1,   14,  154,   11, &
          1,    1,   22,   22, &
          1,    1,   11,   11, &
          1,   42,   77,   66, &
          1,   21,   77,   33, &
          1,   14,  154,   11, &
          1,    1,   11,   11, &
          1,    1,   11,   11, &
          1,    1,   22,   22, &
          4,   28,  308,   44, &
          1,    1,   22,   22, &
          1,   21,   77,   33, &
          1,    1,    1,    1, &
          1,    6,   22,   33, &
          1,   21,   77,   33, &
          1,    1,   22,   22, &
          1,    6,   22,   33, &
          1,    1,    1,    1, &
          4,   84,  308,  132, &
          1,    1,    1,    1, &
          1,    2,   11,   22, &
          1,    2,   11,   22, &
          1,    1,    1,    1, &
          4,   12,   44,  132  /

! ... subshell [7/2]^3

      Integer, parameter :: kd_j7_q3 = 56
      Integer, parameter :: nt_j7_q3 =  6
 
      Integer :: Idet_j7_q3(3,kd_j7_q3)
      Integer :: MD_j7_q3(kd_j7_q3)
      Integer :: ID_j7_q3(nt_j7_q3,kd_j7_q3)
      Integer :: JD_j7_q3(nt_j7_q3,kd_j7_q3)

      Data Idet_j7_q3/ &
          1,    2,    3, &
          1,    2,    4, &
          1,    2,    5, &
          1,    2,    6, &
          1,    2,    7, &
          1,    2,    8, &
          1,    3,    4, &
          1,    3,    5, &
          1,    3,    6, &
          1,    3,    7, &
          1,    3,    8, &
          1,    4,    5, &
          1,    4,    6, &
          1,    4,    7, &
          1,    4,    8, &
          1,    5,    6, &
          1,    5,    7, &
          1,    5,    8, &
          1,    6,    7, &
          1,    6,    8, &
          1,    7,    8, &
          2,    3,    4, &
          2,    3,    5, &
          2,    3,    6, &
          2,    3,    7, &
          2,    3,    8, &
          2,    4,    5, &
          2,    4,    6, &
          2,    4,    7, &
          2,    4,    8, &
          2,    5,    6, &
          2,    5,    7, &
          2,    5,    8, &
          2,    6,    7, &
          2,    6,    8, &
          2,    7,    8, &
          3,    4,    5, &
          3,    4,    6, &
          3,    4,    7, &
          3,    4,    8, &
          3,    5,    6, &
          3,    5,    7, &
          3,    5,    8, &
          3,    6,    7, &
          3,    6,    8, &
          3,    7,    8, &
          4,    5,    6, &
          4,    5,    7, &
          4,    5,    8, &
          4,    6,    7, &
          4,    6,    8, &
          4,    7,    8, &
          5,    6,    7, &
          5,    6,    8, &
          5,    7,    8, &
          6,    7,    8  /

      Data MD_j7_q3/ &
         -3,    3,   -5,    5,   -7,    7,   -1,   -9,    1,  -11, &
          3,   -3,    7,   -5,    9,   -1,  -13,    1,   -3,   11, &
         -1,    1,   -7,    3,   -9,    5,   -1,    9,   -3,   11, &
          1,  -11,    3,   -1,   13,    1,   -5,    5,   -7,    7, &
         -3,  -15,   -1,   -5,    9,   -3,    3,   -9,    5,    1, &
         15,    3,   -7,    7,   -5,    5  /

      Data ID_j7_q3/ &
          1,   -3,    3,   25,    3,    5, &
          1,   -3,   -3,  -25,    3,    5, &
          1,    0,    5,   25,    4,   25, &
          1,    0,   -5,  -25,    4,   25, &
          1,    0,    0, -175,    3,   20, &
          1,    0,    0,  175,    3,   20, &
         -1,    3,   -8,  -40,   -7,  -21, &
          0,    0,    0,  -80,   -4,   -1, &
          0,   -1,  -98,  -90,   -7,  -28, &
          0,    0,    0,    0,   -4,   -3, &
          0,    3,  -28,  -60,    5, -100, &
          0,    6,  -49,   15,   10,   64, &
          0,    0,    0,  -45,    5,    3, &
          0,    0,   -7, -315,   -5,  375, &
          0,    0,    0,   35,    4,   64, &
          1,   -8,   -9,  -55,    0, -175, &
          0,    0,    0,    0,    0,   -1, &
          0,    2,    7, -135,    2,  -64, &
          0,    1,   63,  -45,  -45,  243, &
          0,    0,    0,    0,   -3,    4, &
         -1,   -7,    1,  -35,    7,  -28, &
         -1,    3,    8,   40,   -7,  -21, &
          0,    0,    0,  -45,   -5,   -3, &
          0,   -6,  -49,   15,  -10,  -64, &
          0,    0,    0,   35,   -4,  -64, &
          0,    0,   -7, -315,    5, -375, &
          0,    1,  -98,  -90,    7,   28, &
          0,    0,    0,  -80,    4,    1, &
          0,   -3,  -28,  -60,   -5,  100, &
          0,    0,    0,    0,    4,    3, &
          1,   -8,    9,   55,    0, -175, &
          0,    0,    0,    0,    3,   -4, &
          0,   -1,   63,  -45,   45, -243, &
          0,   -2,    7, -135,   -2,   64, &
          0,    0,    0,    0,    0,    1, &
         -1,   -7,   -1,   35,    7,  -28, &
         -1,    0,   -5,  361,    1,   36, &
         -1,    0,    5, -361,    1,   36, &
         -1,    0,    0,   -7,  -12,   45, &
         -1,    0,    0,    7,  -12,   45, &
          1,    3,   -1, -477,    1,  -20, &
          0,    0,    0,    0,    0,   -1, &
          0,    1,    7,  -81,    5,   -5, &
          0,    0,   35,   63, -100,  192, &
          0,    0,    0,  -28,  -45,   20, &
         -1,    0,   25, -343,    8,   -5, &
          1,    3,    1,  477,    1,  -20, &
          0,    0,    0,  -28,   45,  -20, &
          0,    0,   35,   63,  100, -192, &
          0,   -1,    7,  -81,   -5,    5, &
          0,    0,    0,    0,    0,    1, &
         -1,    0,  -25,  343,    8,   -5, &
          1,    0,    0,  112,  -27,    5, &
          1,    0,    0, -112,  -27,    5, &
         -1,    0,    5,  -49,    1,   -1, &
         -1,    0,   -5,   49,    1,   -1  /

      Data JD_j7_q3/ &
          3,   14,   11, 3003,   22,  143, &
          3,   14,   11, 3003,   22,  143, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,   70,   55, 3003,   22,  143, &
          1,    1,    1,  143,   11,   13, &
          1,   70,  165, 1001,   66,  143, &
          1,    1,    1,    1,    7,    7, &
          1,   10,  165,  143,  462, 1001, &
          1,   35,  660, 4004,   33,  143, &
          1,    1,    1,  143,   11,   13, &
          1,    1,  132,  572,  231, 1001, &
          1,    1,    1,  143,   77,   91, &
          3,  105,  110,  546,    1,  429, &
          1,    1,    1,    1,    1,    1, &
          1,   15,  110,  286,   11,  429, &
          1,   10,  220,  572,  154, 1001, &
          1,    1,    1,    1,    7,    7, &
          3,   30,  110,  858,   22,  429, &
          3,   70,   55, 3003,   22,  143, &
          1,    1,    1,  143,   11,   13, &
          1,   35,  660, 4004,   33,  143, &
          1,    1,    1,  143,   77,   91, &
          1,    1,  132,  572,  231, 1001, &
          1,   70,  165, 1001,   66,  143, &
          1,    1,    1,  143,   11,   13, &
          1,   10,  165,  143,  462, 1001, &
          1,    1,    1,    1,    7,    7, &
          3,  105,  110,  546,    1,  429, &
          1,    1,    1,    1,    7,    7, &
          1,   10,  220,  572,  154, 1001, &
          1,   15,  110,  286,   11,  429, &
          1,    1,    1,    1,    1,    1, &
          3,   30,  110,  858,   22,  429, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,   14,  132, 1646,   66,  143, &
          1,    1,    1,    1,    1,    1, &
          1,    2,   66,  286,   66,  143, &
          1,    1,  132,  572,  231, 1001, &
          1,    1,    1,  143,   77,   91, &
          3,    1,  132, 1716,   33,  143, &
          3,   14,  132, 1646,   66,  143, &
          1,    1,    1,  143,   77,   91, &
          1,    1,  132,  572,  231, 1001, &
          1,    2,   66,  286,   66,  143, &
          1,    1,    1,    1,    1,    1, &
          3,    1,  132, 1716,   33,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,    1,   11,  429,   11,  143, &
          3,    1,   11,  429,   11,  143  /

! ... subshell [7/2]^4

      Integer, parameter :: kd_j7_q4 = 70
      Integer, parameter :: nt_j7_q4 =  8
 
      Integer :: Idet_j7_q4(4,kd_j7_q4)
      Integer :: MD_j7_q4(kd_j7_q4)
      Integer :: ID_j7_q4(nt_j7_q4,kd_j7_q4)
      Integer :: JD_j7_q4(nt_j7_q4,kd_j7_q4)

      Data Idet_j7_q4/ &
          1,    2,    3,    4, &
          1,    2,    3,    5, &
          1,    2,    3,    6, &
          1,    2,    3,    7, &
          1,    2,    3,    8, &
          1,    2,    4,    5, &
          1,    2,    4,    6, &
          1,    2,    4,    7, &
          1,    2,    4,    8, &
          1,    2,    5,    6, &
          1,    2,    5,    7, &
          1,    2,    5,    8, &
          1,    2,    6,    7, &
          1,    2,    6,    8, &
          1,    2,    7,    8, &
          1,    3,    4,    5, &
          1,    3,    4,    6, &
          1,    3,    4,    7, &
          1,    3,    4,    8, &
          1,    3,    5,    6, &
          1,    3,    5,    7, &
          1,    3,    5,    8, &
          1,    3,    6,    7, &
          1,    3,    6,    8, &
          1,    3,    7,    8, &
          1,    4,    5,    6, &
          1,    4,    5,    7, &
          1,    4,    5,    8, &
          1,    4,    6,    7, &
          1,    4,    6,    8, &
          1,    4,    7,    8, &
          1,    5,    6,    7, &
          1,    5,    6,    8, &
          1,    5,    7,    8, &
          1,    6,    7,    8, &
          2,    3,    4,    5, &
          2,    3,    4,    6, &
          2,    3,    4,    7, &
          2,    3,    4,    8, &
          2,    3,    5,    6, &
          2,    3,    5,    7, &
          2,    3,    5,    8, &
          2,    3,    6,    7, &
          2,    3,    6,    8, &
          2,    3,    7,    8, &
          2,    4,    5,    6, &
          2,    4,    5,    7, &
          2,    4,    5,    8, &
          2,    4,    6,    7, &
          2,    4,    6,    8, &
          2,    4,    7,    8, &
          2,    5,    6,    7, &
          2,    5,    6,    8, &
          2,    5,    7,    8, &
          2,    6,    7,    8, &
          3,    4,    5,    6, &
          3,    4,    5,    7, &
          3,    4,    5,    8, &
          3,    4,    6,    7, &
          3,    4,    6,    8, &
          3,    4,    7,    8, &
          3,    5,    6,    7, &
          3,    5,    6,    8, &
          3,    5,    7,    8, &
          3,    6,    7,    8, &
          4,    5,    6,    7, &
          4,    5,    6,    8, &
          4,    5,    7,    8, &
          4,    6,    7,    8, &
          5,    6,    7,    8  /

      Data MD_j7_q4/ &
          0,   -8,    2,  -10,    4,   -2,    8,   -4,   10,    0, &
        -12,    2,   -2,   12,    0,   -6,    4,   -8,    6,   -4, &
        -16,   -2,   -6,    8,   -4,    2,  -10,    4,    0,   14, &
          2,   -8,    6,   -6,    4,   -4,    6,   -6,    8,   -2, &
        -14,    0,   -4,   10,   -2,    4,   -8,    6,    2,   16, &
          4,   -6,    8,   -4,    6,    0,  -12,    2,   -2,   12, &
          0,  -10,    4,   -8,    2,   -4,   10,   -2,    8,    0  /

      Data ID_j7_q4/ &
         -1,    8,   -9,   -2,   -6,   45,    0,   -7, &
          0,    0,  -15,    7,    0,   -3,   -1,    1, &
          0,    4,  -15,   -7,   -3,   75,    0,   -7, &
          0,    0,    0,    1,    0,    0,   -5,    1, &
          0,   -1,  -15,   -5,   -3,    3,    3, -125, &
          0,   -4,   15,    7,    3,  -75,    0,    7, &
          0,    0,   15,   -7,    0,    3,   -1,   -1, &
          0,    1,   15,    5,    3,   -3,    3,  125, &
          0,    0,    0,   -1,    0,    0,   -5,   -1, &
          1,   -2,   -2,  -25,    3,   10,    0, -175, &
          0,    0,    0,    1,    0,    0,    0,    1, &
          0,   -1,   -5,   -1,   -1,   -1,    1,  -27, &
          0,    1,    5,    1,    1,    1,    1,   27, &
          0,    0,    0,   -1,    0,    0,    0,   -1, &
         -1,   -1,  -32,    2,   27,   -5,    0,  -56, &
          0,    0,    2,   -7,    0,    8,    3,   -1, &
          0,   -5,   -1,    7,   -5, -529,    1,   27, &
          0,    0,   -7,  -15,    0,   -7,    3, -135, &
          0,    0,    7,    2,    0,   -7,   -6,   25, &
          0,    5,  -12,    7,   20,   27,   -4,   25, &
          0,    0,    0,    0,    0,    0,    0,   -1, &
          0,    0,    0,    0,   20,    6,   -4,    5, &
          0,    0,    0,    0,    0,  -42,    2,  -27, &
          0,    0,    0,    0,    0,  -21,  -16,   20, &
          0,   -5,   12,   -7,   20,   27,   -4,   25, &
          0,   -5,   27,  -35,  125,   -3,   -7,  -35, &
          0,    0,    0,    0,    0,    0,    2,    5, &
          0,    0,    0,    0,    5,  -12,   16, -512, &
          0,    0,    0,    0,    5,    3,    1,   45, &
          0,    0,    0,    0,    0,    0,    0,   -1, &
          0,    5,  -27,   35,  125,   -3,   -7,  -35, &
          0,    0,    7,   15,    0,   -7,    3, -135, &
          0,    0,   -7,   -2,    0,   -7,   -6,   25, &
          0,    0,    2,   -7,    0,   -8,   -3,    1, &
          0,   -5,   -1,    7,    5,  529,   -1,  -27, &
          0,    5,    1,   -7,    5,  529,    1,  -27, &
          0,    0,   -2,    7,    0,   -8,    3,    1, &
          0,    0,   -7,   -2,    0,    7,   -6,  -25, &
          0,    0,    7,   15,    0,    7,    3,  135, &
          0,    5,  -27,   35, -125,    3,   -7,   35, &
          0,    0,    0,    0,    0,    0,    0,   -1, &
          0,    0,    0,    0,    5,    3,   -1,   45, &
          0,    0,    0,    0,    5,  -12,  -16, -512, &
          0,    0,    0,    0,    0,    0,   -2,    5, &
          0,   -5,   27,  -35, -125,    3,   -7,   35, &
          0,   -5,   12,   -7,  -20,  -27,   -4,  -25, &
          0,    0,    0,    0,    0,  -21,   16,   20, &
          0,    0,    0,    0,    0,  -42,   -2,  -27, &
          0,    0,    0,    0,   20,    6,    4,    5, &
          0,    0,    0,    0,    0,    0,    0,   -1, &
          0,    5,  -12,    7,  -20,  -27,   -4,  -25, &
          0,    0,    7,    2,    0,    7,   -6,  -25, &
          0,    0,   -7,  -15,    0,    7,    3,  135, &
          0,    5,    1,   -7,   -5, -529,   -1,   27, &
          0,    0,   -2,    7,    0,    8,   -3,   -1, &
         -1,    1,   32,   -2,   27,   -5,    0,  -56, &
          0,    0,    0,   -1,    0,    0,    0,    1, &
          0,    1,    5,    1,   -1,   -1,    1,  -27, &
          0,   -1,   -5,   -1,    1,    1,    1,   27, &
          0,    0,    0,    1,    0,    0,    0,   -1, &
          1,    2,    2,   25,    3,   10,    0, -175, &
          0,    0,    0,    1,    0,    0,    5,   -1, &
          0,   -1,  -15,   -5,    3,   -3,   -3,  125, &
          0,    0,   15,   -7,    0,   -3,   -1,    1, &
          0,   -4,   15,    7,   -3,   75,    0,   -7, &
          0,    1,   15,    5,   -3,    3,   -3, -125, &
          0,    0,    0,   -1,    0,    0,    5,    1, &
          0,    4,  -15,   -7,    3,  -75,    0,    7, &
          0,    0,  -15,    7,    0,    3,   -1,   -1, &
         -1,   -8,    9,    2,   -6,   45,    0,   -7  /

      Data JD_j7_q4/ &
          6,   21,  154,   33,   77,  182,    1,  858, &
          1,    1,   44,   44,    1,   13,    4,   52, &
          1,   21,  154,   33,   77,  182,    1,  143, &
          1,    1,    1,    2,    1,    1,   14,    7, &
          1,   12,   44,   66,   11,   52,   28, 2002, &
          1,   21,  154,   33,   77,  182,    1,  143, &
          1,    1,   44,   44,    1,   13,    4,   52, &
          1,   12,   44,   66,   11,   52,   28, 2002, &
          1,    1,    1,    2,    1,    1,   14,    7, &
          6,   21,   77,   66,  154,   91,    1,  858, &
          1,    1,    1,    2,    1,    1,    1,    2, &
          1,    4,   22,   44,   44,   26,    4,  143, &
          1,    4,   22,   44,   44,   26,    4,  143, &
          1,    1,    1,    2,    1,    1,    1,    2, &
          6,   42,   77,   33,  154,  182,    1,  429, &
          1,    1,   11,   22,    1,   65,   10,   13, &
          1,   28,  308,   22,   77, 1820,   20,  286, &
          1,    1,   44,   44,    1,   65,  140,  364, &
          1,    1,   22,   11,    1,  130,   35,   91, &
          1,   21,   77,   66,  231,  455,   15,  286, &
          1,    1,    1,    1,    1,    1,    1,    1, &
          1,    1,    1,    1,   33,   65,   15,  143, &
          1,    1,    1,    1,    1,   65,   35,   91, &
          1,    1,    1,    1,    1,   65,   35,   91, &
          1,   21,   77,   66,  231,  455,   15,  286, &
          1,   84,  154,  132,  924,  910,   60,  143, &
          1,    1,    1,    1,    1,    1,    7,    7, &
          1,    1,    1,    1,   33,   65,  105, 1001, &
          1,    1,    1,    1,   22,   26,    2,  286, &
          1,    1,    1,    1,    1,    1,    1,    1, &
          1,   84,  154,  132,  924,  910,   60,  143, &
          1,    1,   44,   44,    1,   65,  140,  364, &
          1,    1,   22,   11,    1,  130,   35,   91, &
          1,    1,   11,   22,    1,   65,   10,   13, &
          1,   28,  308,   22,   77, 1820,   20,  286, &
          1,   28,  308,   22,   77, 1820,   20,  286, &
          1,    1,   11,   22,    1,   65,   10,   13, &
          1,    1,   22,   11,    1,  130,   35,   91, &
          1,    1,   44,   44,    1,   65,  140,  364, &
          1,   84,  154,  132,  924,  910,   60,  143, &
          1,    1,    1,    1,    1,    1,    1,    1, &
          1,    1,    1,    1,   22,   26,    2,  286, &
          1,    1,    1,    1,   33,   65,  105, 1001, &
          1,    1,    1,    1,    1,    1,    7,    7, &
          1,   84,  154,  132,  924,  910,   60,  143, &
          1,   21,   77,   66,  231,  455,   15,  286, &
          1,    1,    1,    1,    1,   65,   35,   91, &
          1,    1,    1,    1,    1,   65,   35,   91, &
          1,    1,    1,    1,   33,   65,   15,  143, &
          1,    1,    1,    1,    1,    1,    1,    1, &
          1,   21,   77,   66,  231,  455,   15,  286, &
          1,    1,   22,   11,    1,  130,   35,   91, &
          1,    1,   44,   44,    1,   65,  140,  364, &
          1,   28,  308,   22,   77, 1820,   20,  286, &
          1,    1,   11,   22,    1,   65,   10,   13, &
          6,   42,   77,   33,  154,  182,    1,  429, &
          1,    1,    1,    2,    1,    1,    1,    2, &
          1,    4,   22,   44,   44,   26,    4,  143, &
          1,    4,   22,   44,   44,   26,    4,  143, &
          1,    1,    1,    2,    1,    1,    1,    2, &
          6,   21,   77,   66,  154,   91,    1,  858, &
          1,    1,    1,    2,    1,    1,   14,    7, &
          1,   12,   44,   66,   11,   52,   28, 2002, &
          1,    1,   44,   44,    1,   13,    4,   52, &
          1,   21,  154,   33,   77,  182,    1,  143, &
          1,   12,   44,   66,   11,   52,   28, 2002, &
          1,    1,    1,    2,    1,    1,   14,    7, &
          1,   21,  154,   33,   77,  182,    1,  143, &
          1,    1,   44,   44,    1,   13,    4,   52, &
          6,   21,  154,   33,   77,  182,    1,  858  /

! ... subshell [7/2]^5

      Integer, parameter :: kd_j7_q5 = 56
      Integer, parameter :: nt_j7_q5 =  6
 
      Integer :: Idet_j7_q5(5,kd_j7_q5)
      Integer :: MD_j7_q5(kd_j7_q5)
      Integer :: ID_j7_q5(nt_j7_q5,kd_j7_q5)
      Integer :: JD_j7_q5(nt_j7_q5,kd_j7_q5)

      Data Idet_j7_q5/ &
          1,    2,    3,    4,    5, &
          1,    2,    3,    4,    6, &
          1,    2,    3,    4,    7, &
          1,    2,    3,    4,    8, &
          1,    2,    3,    5,    6, &
          1,    2,    3,    5,    7, &
          1,    2,    3,    5,    8, &
          1,    2,    3,    6,    7, &
          1,    2,    3,    6,    8, &
          1,    2,    3,    7,    8, &
          1,    2,    4,    5,    6, &
          1,    2,    4,    5,    7, &
          1,    2,    4,    5,    8, &
          1,    2,    4,    6,    7, &
          1,    2,    4,    6,    8, &
          1,    2,    4,    7,    8, &
          1,    2,    5,    6,    7, &
          1,    2,    5,    6,    8, &
          1,    2,    5,    7,    8, &
          1,    2,    6,    7,    8, &
          1,    3,    4,    5,    6, &
          1,    3,    4,    5,    7, &
          1,    3,    4,    5,    8, &
          1,    3,    4,    6,    7, &
          1,    3,    4,    6,    8, &
          1,    3,    4,    7,    8, &
          1,    3,    5,    6,    7, &
          1,    3,    5,    6,    8, &
          1,    3,    5,    7,    8, &
          1,    3,    6,    7,    8, &
          1,    4,    5,    6,    7, &
          1,    4,    5,    6,    8, &
          1,    4,    5,    7,    8, &
          1,    4,    6,    7,    8, &
          1,    5,    6,    7,    8, &
          2,    3,    4,    5,    6, &
          2,    3,    4,    5,    7, &
          2,    3,    4,    5,    8, &
          2,    3,    4,    6,    7, &
          2,    3,    4,    6,    8, &
          2,    3,    4,    7,    8, &
          2,    3,    5,    6,    7, &
          2,    3,    5,    6,    8, &
          2,    3,    5,    7,    8, &
          2,    3,    6,    7,    8, &
          2,    4,    5,    6,    7, &
          2,    4,    5,    6,    8, &
          2,    4,    5,    7,    8, &
          2,    4,    6,    7,    8, &
          2,    5,    6,    7,    8, &
          3,    4,    5,    6,    7, &
          3,    4,    5,    6,    8, &
          3,    4,    5,    7,    8, &
          3,    4,    6,    7,    8, &
          3,    5,    6,    7,    8, &
          4,    5,    6,    7,    8  /

      Data MD_j7_q5/ &
         -5,    5,   -7,    7,   -3,  -15,   -1,   -5,    9,   -3, &
          3,   -9,    5,    1,   15,    3,   -7,    7,   -5,    5, &
         -1,  -13,    1,   -3,   11,   -1,  -11,    3,   -9,    1, &
         -5,    9,   -3,    7,   -1,    1,  -11,    3,   -1,   13, &
          1,   -9,    5,   -7,    3,   -3,   11,   -1,    9,    1, &
         -7,    7,   -5,    5,   -3,    3  /

      Data ID_j7_q5/ &
         -1,    0,   -5,   49,   -1,    1, &
         -1,    0,    5,  -49,   -1,    1, &
         -1,    0,    0,  112,  -27,    5, &
         -1,    0,    0, -112,  -27,    5, &
          1,    0,   25, -343,    8,   -5, &
          0,    0,    0,    0,    0,   -1, &
          0,    1,    7,  -81,    5,   -5, &
          0,    0,   35,   63, -100,  192, &
          0,    0,    0,  -28,  -45,   20, &
         -1,    3,   -1, -477,    1,  -20, &
          1,    0,  -25,  343,    8,   -5, &
          0,    0,    0,  -28,   45,  -20, &
          0,    0,   35,   63,  100, -192, &
          0,   -1,    7,  -81,   -5,    5, &
          0,    0,    0,    0,    0,    1, &
         -1,    3,    1,  477,    1,  -20, &
          1,    0,    0,   -7,  -12,   45, &
          1,    0,    0,    7,  -12,   45, &
         -1,    0,    5, -361,   -1,  -36, &
         -1,    0,   -5,  361,   -1,  -36, &
         -1,    7,   -1,   35,   -7,   28, &
          0,    0,    0,    0,    0,    1, &
          0,   -2,   -7,  135,   -2,   64, &
          0,   -1,  -63,   45,   45, -243, &
          0,    0,    0,    0,    3,   -4, &
          1,    8,    9,   55,    0,  175, &
          0,    0,    0,    0,   -4,   -3, &
          0,    3,  -28,  -60,    5, -100, &
          0,    0,    0,   80,    4,    1, &
          0,    1,   98,   90,    7,   28, &
          0,    0,   -7, -315,   -5,  375, &
          0,    0,    0,   35,    4,   64, &
          0,   -6,   49,  -15,  -10,  -64, &
          0,    0,    0,   45,   -5,   -3, &
         -1,   -3,    8,   40,    7,   21, &
         -1,    7,    1,  -35,   -7,   28, &
          0,    0,    0,    0,   -3,    4, &
          0,    1,  -63,   45,  -45,  243, &
          0,    2,   -7,  135,    2,  -64, &
          0,    0,    0,    0,    0,   -1, &
          1,    8,   -9,  -55,    0,  175, &
          0,    0,    0,   35,   -4,  -64, &
          0,    0,   -7, -315,    5, -375, &
          0,    0,    0,   45,    5,    3, &
          0,    6,   49,  -15,   10,   64, &
          0,   -3,  -28,  -60,   -5,  100, &
          0,    0,    0,    0,    4,    3, &
          0,   -1,   98,   90,   -7,  -28, &
          0,    0,    0,   80,   -4,   -1, &
         -1,   -3,   -8,  -40,    7,   21, &
         -1,    0,    0, -175,    3,   20, &
         -1,    0,    0,  175,    3,   20, &
          1,    0,   -5,  -25,   -4,  -25, &
          1,    0,    5,   25,   -4,  -25, &
         -1,   -3,    3,   25,    3,    5, &
         -1,   -3,   -3,  -25,    3,    5  /

      Data JD_j7_q5/ &
          3,    1,   11,  429,   11,  143, &
          3,    1,   11,  429,   11,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,    1,  132, 1716,   33,  143, &
          1,    1,    1,    1,    1,    1, &
          1,    2,   66,  286,   66,  143, &
          1,    1,  132,  572,  231, 1001, &
          1,    1,    1,  143,   77,   91, &
          3,   14,  132, 1646,   66,  143, &
          3,    1,  132, 1716,   33,  143, &
          1,    1,    1,  143,   77,   91, &
          1,    1,  132,  572,  231, 1001, &
          1,    2,   66,  286,   66,  143, &
          1,    1,    1,    1,    1,    1, &
          3,   14,  132, 1646,   66,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,   44, 1716,   11,  143, &
          3,   30,  110,  858,   22,  429, &
          1,    1,    1,    1,    1,    1, &
          1,   15,  110,  286,   11,  429, &
          1,   10,  220,  572,  154, 1001, &
          1,    1,    1,    1,    7,    7, &
          3,  105,  110,  546,    1,  429, &
          1,    1,    1,    1,    7,    7, &
          1,   10,  165,  143,  462, 1001, &
          1,    1,    1,  143,   11,   13, &
          1,   70,  165, 1001,   66,  143, &
          1,    1,  132,  572,  231, 1001, &
          1,    1,    1,  143,   77,   91, &
          1,   35,  660, 4004,   33,  143, &
          1,    1,    1,  143,   11,   13, &
          3,   70,   55, 3003,   22,  143, &
          3,   30,  110,  858,   22,  429, &
          1,    1,    1,    1,    7,    7, &
          1,   10,  220,  572,  154, 1001, &
          1,   15,  110,  286,   11,  429, &
          1,    1,    1,    1,    1,    1, &
          3,  105,  110,  546,    1,  429, &
          1,    1,    1,  143,   77,   91, &
          1,    1,  132,  572,  231, 1001, &
          1,    1,    1,  143,   11,   13, &
          1,   35,  660, 4004,   33,  143, &
          1,   10,  165,  143,  462, 1001, &
          1,    1,    1,    1,    7,    7, &
          1,   70,  165, 1001,   66,  143, &
          1,    1,    1,  143,   11,   13, &
          3,   70,   55, 3003,   22,  143, &
          3,    1,    1,  429,   77,   91, &
          3,    1,    1,  429,   77,   91, &
          3,    1,   44, 1716,   11,  143, &
          3,    1,   44, 1716,   11,  143, &
          3,   14,   11, 3003,   22,  143, &
          3,   14,   11, 3003,   22,  143  /

! ... subshell [7/2]^6

      Integer, parameter :: kd_j7_q6 = 28
      Integer, parameter :: nt_j7_q6 =  4
 
      Integer :: Idet_j7_q6(6,kd_j7_q6)
      Integer :: MD_j7_q6(kd_j7_q6)
      Integer :: ID_j7_q6(nt_j7_q6,kd_j7_q6)
      Integer :: JD_j7_q6(nt_j7_q6,kd_j7_q6)

      Data Idet_j7_q6/ &
          1,    2,    3,    4,    5,    6, &
          1,    2,    3,    4,    5,    7, &
          1,    2,    3,    4,    5,    8, &
          1,    2,    3,    4,    6,    7, &
          1,    2,    3,    4,    6,    8, &
          1,    2,    3,    4,    7,    8, &
          1,    2,    3,    5,    6,    7, &
          1,    2,    3,    5,    6,    8, &
          1,    2,    3,    5,    7,    8, &
          1,    2,    3,    6,    7,    8, &
          1,    2,    4,    5,    6,    7, &
          1,    2,    4,    5,    6,    8, &
          1,    2,    4,    5,    7,    8, &
          1,    2,    4,    6,    7,    8, &
          1,    2,    5,    6,    7,    8, &
          1,    3,    4,    5,    6,    7, &
          1,    3,    4,    5,    6,    8, &
          1,    3,    4,    5,    7,    8, &
          1,    3,    4,    6,    7,    8, &
          1,    3,    5,    6,    7,    8, &
          1,    4,    5,    6,    7,    8, &
          2,    3,    4,    5,    6,    7, &
          2,    3,    4,    5,    6,    8, &
          2,    3,    4,    5,    7,    8, &
          2,    3,    4,    6,    7,    8, &
          2,    3,    5,    6,    7,    8, &
          2,    4,    5,    6,    7,    8, &
          3,    4,    5,    6,    7,    8  /

      Data MD_j7_q6/ &
          0,  -12,    2,   -2,   12,    0,  -10,    4,   -8,    2, &
         -4,   10,   -2,    8,    0,   -8,    6,   -6,    4,   -4, &
          2,   -6,    8,   -4,    6,   -2,    4,    0  /

      Data ID_j7_q6/ &
         -1,    7,    7,    1, &
          0,    0,    0,   -1, &
          0,    1,    5,    1, &
          0,   -1,   -5,   -1, &
          0,    0,    0,    1, &
          1,   -1,  169,   25, &
          0,    0,    0,    1, &
          0,   -1,  -15,   -5, &
          0,    0,   15,   -7, &
          0,   -8,   15,   14, &
          0,    1,   15,    5, &
          0,    0,    0,   -1, &
          0,    8,  -15,  -14, &
          0,    0,  -15,    7, &
         -1,   -3,   -9,   27, &
          0,    0,   -7,  -15, &
          0,    0,    7,    4, &
          0,    0,   -4,    7, &
          0,    5,    1,   -7, &
          0,  -10,   24,   -7, &
          0,    5,  -27,   35, &
          0,    0,   -7,   -4, &
          0,    0,    7,   15, &
          0,   -5,   -1,    7, &
          0,    0,    4,   -7, &
          0,   -5,   27,  -35, &
          0,   10,  -24,    7, &
          1,   25,  -81,   25  /

      Data JD_j7_q6/ &
          4,   12,   44,  132, &
          1,    1,    1,    1, &
          1,    2,   11,   22, &
          1,    2,   11,   22, &
          1,    1,    1,    1, &
          4,   84,  308,  132, &
          1,    1,    1,    1, &
          1,    6,   22,   33, &
          1,    1,   22,   22, &
          1,   21,   77,   33, &
          1,    6,   22,   33, &
          1,    1,    1,    1, &
          1,   21,   77,   33, &
          1,    1,   22,   22, &
          4,   28,  308,   44, &
          1,    1,   22,   22, &
          1,    1,   11,   11, &
          1,    1,   11,   11, &
          1,   14,  154,   11, &
          1,   21,   77,   33, &
          1,   42,   77,   66, &
          1,    1,   11,   11, &
          1,    1,   22,   22, &
          1,   14,  154,   11, &
          1,    1,   11,   11, &
          1,   42,   77,   66, &
          1,   21,   77,   33, &
          4,   84,  308,  132  /

! ... subshell [7/2]^7

      Integer, parameter :: kd_j7_q7 =  8
      Integer, parameter :: nt_j7_q7 =  1
 
      Integer :: Idet_j7_q7(7,kd_j7_q7)
      Integer :: MD_j7_q7(kd_j7_q7)
      Integer :: ID_j7_q7(nt_j7_q7,kd_j7_q7)
      Integer :: JD_j7_q7(nt_j7_q7,kd_j7_q7)

      Data Idet_j7_q7/ &
          1,    2,    3,    4,    5,    6,    7, &
          1,    2,    3,    4,    5,    6,    8, &
          1,    2,    3,    4,    5,    7,    8, &
          1,    2,    3,    4,    6,    7,    8, &
          1,    2,    3,    5,    6,    7,    8, &
          1,    2,    4,    5,    6,    7,    8, &
          1,    3,    4,    5,    6,    7,    8, &
          2,    3,    4,    5,    6,    7,    8  /

      Data MD_j7_q7/ &
         -7,    7,   -5,    5,   -3,    3,   -1,    1  /

      Data ID_j7_q7/ &
         -1, &
         -1, &
          1, &
          1, &
         -1, &
         -1, &
          1, &
          1  /

      Data JD_j7_q7/ &
          1, &
          1, &
          1, &
          1, &
          1, &
          1, &
          1, &
          1  /

! ... subshell [7/2]^8

      Integer, parameter :: kd_j7_q8 =  1
      Integer, parameter :: nt_j7_q8 =  1
 
      Integer :: Idet_j7_q8(8,kd_j7_q8)
      Integer :: MD_j7_q8(kd_j7_q8)
      Integer :: ID_j7_q8(nt_j7_q8,kd_j7_q8)
      Integer :: JD_j7_q8(nt_j7_q8,kd_j7_q8)

      Data Idet_j7_q8/ &
          1,    2,    3,    4,    5,    6,    7,    8  /

      Data MD_j7_q8/ &
          0  /

      Data ID_j7_q8/ &
          1  /

      Data JD_j7_q8/ &
          1  /

! ... subshell [9/2]^2

      Integer, parameter :: kd_j9_q2 = 45
      Integer, parameter :: nt_j9_q2 =  5
 
      Integer :: Idet_j9_q2(2,kd_j9_q2)
      Integer :: MD_j9_q2(kd_j9_q2)
      Integer :: ID_j9_q2(nt_j9_q2,kd_j9_q2)
      Integer :: JD_j9_q2(nt_j9_q2,kd_j9_q2)

      Data Idet_j9_q2/ &
          1,    2, &
          1,    3, &
          1,    4, &
          1,    5, &
          1,    6, &
          1,    7, &
          1,    8, &
          1,    9, &
          1,   10, &
          2,    3, &
          2,    4, &
          2,    5, &
          2,    6, &
          2,    7, &
          2,    8, &
          2,    9, &
          2,   10, &
          3,    4, &
          3,    5, &
          3,    6, &
          3,    7, &
          3,    8, &
          3,    9, &
          3,   10, &
          4,    5, &
          4,    6, &
          4,    7, &
          4,    8, &
          4,    9, &
          4,   10, &
          5,    6, &
          5,    7, &
          5,    8, &
          5,    9, &
          5,   10, &
          6,    7, &
          6,    8, &
          6,    9, &
          6,   10, &
          7,    8, &
          7,    9, &
          7,   10, &
          8,    9, &
          8,   10, &
          9,   10  /

      Data MD_j9_q2/ &
          0,   -4,    2,   -6,    4,   -8,    6,  -10,    8,   -2, &
          4,   -4,    6,   -6,    8,   -8,   10,    0,   -8,    2, &
        -10,    4,  -12,    6,   -2,    8,   -4,   10,   -6,   12, &
          0,  -12,    2,  -14,    4,   -2,   12,   -4,   14,    0, &
        -16,    2,   -2,   16,    0  /

      Data ID_j9_q2/ &
         -1,    8, -162,   32,  -98, &
          0,  -25,   75,   -7,   21, &
          0,    2,  -27,   56, -294, &
          0,    0,   25,   -4,    6, &
          0,   -7,    7,    1,  -81, &
          0,    0,  -50,   -3,   81, &
          0,    0,   64,   -1,   -6, &
          0,    0,    0,    3,    2, &
          0,    0,  -18,  -15,   -5, &
          0,   -2,   27,  -56,  294, &
          0,   25,  -75,    7,  -21, &
          0,    7,   -7,   -1,   81, &
          0,    0,  -25,    4,   -6, &
          0,    0,  -64,    1,    6, &
          0,    0,   50,    3,  -81, &
          0,    0,   18,   15,    5, &
          0,    0,    0,   -3,   -2, &
          1,   -3,    9,    6, -392, &
          0,    0,   75,  -16,   12, &
          0,   -7,   42,   -4, -336, &
          0,    0,    0,   -2,    3, &
          0,    7,   21,  -25,  -75, &
          0,    0,    0,    3,    7, &
          0,    0,  -54,   -6,   -1, &
          0,    7,  -42,    4,  336, &
          0,    0,  -75,   16,  -12, &
          0,   -7,  -21,   25,   75, &
          0,    0,    0,    2,   -3, &
          0,    0,   54,    6,    1, &
          0,    0,    0,   -3,   -7, &
         -1,    1,  289,  -10,  -40, &
          0,    0,    0,   -7,    3, &
          0,    4,   -2,  -28,  -81, &
          0,    0,    0,    0,    1, &
          0,   -1,  -81,   -7,   -7, &
          0,   -4,    2,   28,   81, &
          0,    0,    0,    7,   -3, &
          0,    1,   81,    7,    7, &
          0,    0,    0,    0,   -1, &
          1,    2,  -22,  -11,  -49, &
          0,    0,    0,    0,    1, &
          0,   -4,  -72,   -7,   -4, &
          0,    4,   72,    7,    4, &
          0,    0,    0,    0,   -1, &
         -1,   -6, -162,   -3,    0  /

      Data JD_j9_q2/ &
          5,   33,  715,  165,  715, &
          1,   66,  286,   33,  143, &
          1,   33,  143,  165,  715, &
          1,    1,  143,   11,   13, &
          1,   22,  286,   11,  143, &
          1,    1,  143,  110,  130, &
          1,    1,  143,   11,   13, &
          1,    1,    1,    5,    5, &
          1,    1,  143,   22,   26, &
          1,   33,  143,  165,  715, &
          1,   66,  286,   33,  143, &
          1,   22,  286,   11,  143, &
          1,    1,  143,   11,   13, &
          1,    1,  143,   11,   13, &
          1,    1,  143,  110,  130, &
          1,    1,  143,   22,   26, &
          1,    1,    1,    5,    5, &
          5,   22, 1430,   55,  715, &
          1,    1,  143,   55,   65, &
          1,   33,  143,  165,  715, &
          1,    1,    1,    5,    5, &
          1,   33,  143,   66,  286, &
          1,    1,    1,   10,   10, &
          1,    1,  143,   11,   13, &
          1,   33,  143,  165,  715, &
          1,    1,  143,   55,   65, &
          1,   33,  143,   66,  286, &
          1,    1,    1,    5,    5, &
          1,    1,  143,   11,   13, &
          1,    1,    1,   10,   10, &
          5,   66, 1430,   33,  143, &
          1,    1,    1,   10,   10, &
          1,   11,  143,   55,  715, &
          1,    1,    1,    1,    1, &
          1,   11,  143,   22,  286, &
          1,   11,  143,   55,  715, &
          1,    1,    1,   10,   10, &
          1,   11,  143,   22,  286, &
          1,    1,    1,    1,    1, &
          5,   33,   65,   30, 1430, &
          1,    1,    1,    1,    1, &
          1,   11,  143,   55,  715, &
          1,   11,  143,   55,  715, &
          1,    1,    1,    1,    1, &
          5,   11,  715,  110,    1  /

! ... subshell [11/2]^2

      Integer, parameter :: kd_j11_q2 = 66
      Integer, parameter :: nt_j11_q2 =  6
 
      Integer :: Idet_j11_q2(2,kd_j11_q2)
      Integer :: MD_j11_q2(kd_j11_q2)
      Integer :: ID_j11_q2(nt_j11_q2,kd_j11_q2)
      Integer :: JD_j11_q2(nt_j11_q2,kd_j11_q2)

      Data Idet_j11_q2/ &
          1,    2, &
          1,    3, &
          1,    4, &
          1,    5, &
          1,    6, &
          1,    7, &
          1,    8, &
          1,    9, &
          1,   10, &
          1,   11, &
          1,   12, &
          2,    3, &
          2,    4, &
          2,    5, &
          2,    6, &
          2,    7, &
          2,    8, &
          2,    9, &
          2,   10, &
          2,   11, &
          2,   12, &
          3,    4, &
          3,    5, &
          3,    6, &
          3,    7, &
          3,    8, &
          3,    9, &
          3,   10, &
          3,   11, &
          3,   12, &
          4,    5, &
          4,    6, &
          4,    7, &
          4,    8, &
          4,    9, &
          4,   10, &
          4,   11, &
          4,   12, &
          5,    6, &
          5,    7, &
          5,    8, &
          5,    9, &
          5,   10, &
          5,   11, &
          5,   12, &
          6,    7, &
          6,    8, &
          6,    9, &
          6,   10, &
          6,   11, &
          6,   12, &
          7,    8, &
          7,    9, &
          7,   10, &
          7,   11, &
          7,   12, &
          8,    9, &
          8,   10, &
          8,   11, &
          8,   12, &
          9,   10, &
          9,   11, &
          9,   12, &
         10,   11, &
         10,   12, &
         11,   12  /

      Data MD_j11_q2/ &
          0,   -4,    2,   -6,    4,   -8,    6,  -10,    8,  -12, &
         10,   -2,    4,   -4,    6,   -6,    8,   -8,   10,  -10, &
         12,    0,   -8,    2,  -10,    4,  -12,    6,  -14,    8, &
         -2,    8,   -4,   10,   -6,   12,   -8,   14,    0,  -12, &
          2,  -14,    4,  -16,    6,   -2,   12,   -4,   14,   -6, &
         16,    0,  -16,    2,  -18,    4,   -2,   16,   -4,   18, &
          0,  -20,    2,   -2,   20,    0  /

      Data ID_j11_q2/ &
          1, -175,   28, -100,  991, -441, &
          0,   45,  -32,   36, -432,  462, &
          0,   -5,   16,  -40,  840, -879, &
          0,    0,  -14,   81,  -81,  231, &
          0,   40,   -9,   -1,  867, -862, &
          0,    0,  189,   -5, -125,  693, &
          0,    0,  -42,  128,   -1, -154, &
          0,    0,    0,   -8,    1,  154, &
          0,    0,  105,  169, -289, -385, &
          0,    0,    0,   11,   77,   70, &
          0,    0,    0,  -11,  -11,  -63, &
          0,    5,  -16,   40, -840,  879, &
          0,  -45,   32,  -36,  432, -462, &
          0,  -40,    9,    1, -867,  862, &
          0,    0,   14,  -81,   81, -231, &
          0,    0,   42, -128,    1,  154, &
          0,    0, -189,    5,  125, -693, &
          0,    0, -105, -169,  289,  385, &
          0,    0,    0,    8,   -1, -154, &
          0,    0,    0,   11,   11,   63, &
          0,    0,    0,  -11,  -77,  -70, &
         -1,  841,  -36,   -4,  804, -299, &
          0,    0, -245,  189, -189,  165, &
          0,  128, -250,   28,    3, -961, &
          0,    0,    0,    7,   -7,  275, &
          0, -216,  -15,  105, -875, -799, &
          0,    0,    0,  -35,   -5,  198, &
          0,    0,   54,    7, -343,  -99, &
          0,    0,    0,    0,   11,    8, &
          0,    0,   -3,  -35, -385,  -49, &
          0, -128,  250,  -28,   -3,  961, &
          0,    0,  245, -189,  189, -165, &
          0,  216,   15, -105,  875,  799, &
          0,    0,    0,   -7,    7, -275, &
          0,    0,  -54,   -7,  343,   99, &
          0,    0,    0,   35,    5, -198, &
          0,    0,    3,   35,  385,   49, &
          0,    0,    0,    0,  -11,   -8, &
          1, -289,  -13,  625, -325, -356, &
          0,    0,    0,   28,  -16,   55, &
          0, -243,  135,   21, -889, -757, &
          0,    0,    0,    0,   -8,   11, &
          0,  135,   39,  -21,  -91, -539, &
          0,    0,    0,    0,   11,   27, &
          0,    0,   -3,  -28, -154,   -4, &
          0,  243, -135,  -21,  889,  757, &
          0,    0,    0,  -28,   16,  -55, &
          0, -135,  -39,   21,   91,  539, &
          0,    0,    0,    0,    8,  -11, &
          0,    0,    3,   28,  154,    4, &
          0,    0,    0,    0,  -11,  -27, &
         -1,    0,   99,  -11, -420, -481, &
          0,    0,    0,    0,  -27,   11, &
          0,  320,    9,  -70, -750,  -88, &
          0,    0,    0,    0,    0,    1, &
          0,   -5,  -81,   -7,  -21,  -27, &
          0, -320,   -9,   70,  750,   88, &
          0,    0,    0,    0,   27,  -11, &
          0,    5,   81,    7,   21,   27, &
          0,    0,    0,    0,    0,   -1, &
          1,  625, -729, -961, -185,  -67, &
          0,    0,    0,    0,    0,    1, &
          0,  -25,  -45,   -7,   -6,    0, &
          0,   25,   45,    7,    6,    0, &
          0,    0,    0,    0,    0,   -1, &
         -1, -275,  -99,  -11,  -11,    0  /

      Data JD_j11_q2/ &
          6,  858,  143,  561, 6594, 4199, &
          1,  143,  143,  187, 2717, 4199, &
          1,  143,  143,  187, 2717, 2663, &
          1,    1,  143,  374,  247,  646, &
          1,  143,  143,  374, 5434, 1741, &
          1,    1,  572,  748,  988, 1292, &
          1,    1,  143,  561,  741,  323, &
          1,    1,    1,   17,   19,  323, &
          1,    1,  572,  748,  988, 1292, &
          1,    1,    1,  102,  114,  323, &
          1,    1,    1,   34,   19,  646, &
          1,  143,  143,  187, 2717, 2663, &
          1,  143,  143,  187, 2717, 4199, &
          1,  143,  143,  374, 5434, 1741, &
          1,    1,  143,  374,  247,  646, &
          1,    1,  143,  561,  741,  323, &
          1,    1,  572,  748,  988, 1292, &
          1,    1,  572,  748,  988, 1292, &
          1,    1,    1,   17,   19,  323, &
          1,    1,    1,   34,   19,  646, &
          1,    1,    1,  102,  114,  323, &
          6, 6006, 1001,  561, 4787,  620, &
          1,    1,  572,  748,  988, 1292, &
          1, 1001, 1001,  187, 2717, 2038, &
          1,    1,    1,   34,   19,  646, &
          1, 1001, 1001,  374, 5434, 2440, &
          1,    1,    1,  102,  114,  323, &
          1,    1,  143, 1122,  741,  646, &
          1,    1,    1,    1,   19,   19, &
          1,    1,   52,   68,  988, 1292, &
          1, 1001, 1001,  187, 2717, 2038, &
          1,    1,  572,  748,  988, 1292, &
          1, 1001, 1001,  374, 5434, 2440, &
          1,    1,    1,   34,   19,  646, &
          1,    1,  143, 1122,  741,  646, &
          1,    1,    1,  102,  114,  323, &
          1,    1,   52,   68,  988, 1292, &
          1,    1,    1,    1,   19,   19, &
          6, 6006,  308, 2244, 2508, 1063, &
          1,    1,    1,   51,   57,  323, &
          1, 1001, 1001,  374, 2283, 4281, &
          1,    1,    1,    1,   19,   19, &
          1, 1001,  154,  187,  209, 8398, &
          1,    1,    1,    1,   38,   38, &
          1,    1,   13,   51,  741,  323, &
          1, 1001, 1001,  374, 2283, 4281, &
          1,    1,    1,   51,   57,  323, &
          1, 1001,  154,  187,  209, 8398, &
          1,    1,    1,    1,   19,   19, &
          1,    1,   13,   51,  741,  323, &
          1,    1,    1,    1,   38,   38, &
          6,    1,  364,  204,  967, 6595, &
          1,    1,    1,    1,   38,   38, &
          1, 1001, 1001,  187, 2717, 4199, &
          1,    1,    1,    1,    1,    1, &
          1,   91,  182,   17,  247, 8398, &
          1, 1001, 1001,  187, 2717, 4199, &
          1,    1,    1,    1,   38,   38, &
          1,   91,  182,   17,  247, 8398, &
          1,    1,    1,    1,    1,    1, &
          6, 6006, 4004, 2244, 1621,13893, &
          1,    1,    1,    1,    1,    1, &
          1,   91,   91,   34,  247,    1, &
          1,   91,   91,   34,  247,    1, &
          1,    1,    1,    1,    1,    1, &
          6,  546,  364,  204, 2964,    1  /

      End Module det_jq


!====================================================================
      Subroutine  DET_sh_jq (j,q,id,MJ,Idet)
!====================================================================
!     gives the determinant id and MJ for the subshell j^q
!     Input:  jq - subshell
!             id - the determinant pointer
!     Output: Idet - description of the determinant as
!                    list of orbital positions in the common list
!             MJ - total azimutal quantum numbers (2*m+1)
!     Calls:  MJL_id, MS_id
!-----------------------------------------------------------------------
      Use det_jq

      Implicit none 
      Integer, intent(in) :: j,q,id
      Integer, intent(out) :: MJ
      Integer, intent(out) :: Idet(q)
      Integer :: i,ii,k,nd,nq
      Integer, external :: MJ_value

      if(id.le.0.or.j.lt.0) Call DET_stop (j,q,id)
!-----------------------------------------------------------------------
! ... two-electron case for j>11, the only case we should compute:

      if(q.eq.2.and.j.gt.11) then       
       nq=j+1; nd=nq*(nq-1)/2; if(id.gt.nd) Call DET_stop(j,q,id)
       k=0
       Do i=1,nq-1
        Do ii=i+1,nq
         k=k+1; if(k.eq.id) Exit
        End do
        if(k.eq.id) Exit
       End do
       Idet(1)=i; Idet(2)=j
       MJ = mj_value(id)
       Return
!----------------------------------------------------------------------

      elseif(q.eq.1) then                             ! j^1 - subshell:

       if(id.gt.j+1) Call DET_stop (j,q,id)
       MJ=MJ_value(id)
       Idet(1)=id
       Return
     
      else

      SELECT CASE(j*100+q)

      CASE(102)                                   !  [1/2]^2 - subshell
       if(id.gt.kd_j1_q2) Call DET_stop(j,q,id)
       MJ = MD_j1_q2(id)
       Idet(1:q)= Idet_j1_q2(1:q,id)
      CASE(302)                                   !  [3/2]^2 - subshell
       if(id.gt.kd_j3_q2) Call DET_stop(j,q,id)
       MJ = MD_j3_q2(id)
       Idet(1:q)= Idet_j3_q2(1:q,id)
      CASE(303)                                   !  [3/2]^3 - subshell
       if(id.gt.kd_j3_q3) Call DET_stop(j,q,id)
       MJ = MD_j3_q3(id)
       Idet(1:q)= Idet_j3_q3(1:q,id)
      CASE(304)                                   !  [3/2]^4 - subshell
       if(id.gt.kd_j3_q4) Call DET_stop(j,q,id)
       MJ = MD_j3_q4(id)
       Idet(1:q)= Idet_j3_q4(1:q,id)
      CASE(502)                                   !  [5/2]^2 - subshell
       if(id.gt.kd_j5_q2) Call DET_stop(j,q,id)
       MJ = MD_j5_q2(id)
       Idet(1:q)= Idet_j5_q2(1:q,id)
      CASE(503)                                   !  [5/2]^3 - subshell
       if(id.gt.kd_j5_q3) Call DET_stop(j,q,id)
       MJ = MD_j5_q3(id)
       Idet(1:q)= Idet_j5_q3(1:q,id)
      CASE(504)                                   !  [5/2]^4 - subshell
       if(id.gt.kd_j5_q4) Call DET_stop(j,q,id)
       MJ = MD_j5_q4(id)
       Idet(1:q)= Idet_j5_q4(1:q,id)
      CASE(505)                                   !  [5/2]^5 - subshell
       if(id.gt.kd_j5_q5) Call DET_stop(j,q,id)
       MJ = MD_j5_q5(id)
       Idet(1:q)= Idet_j5_q5(1:q,id)
      CASE(506)                                   !  [5/2]^6 - subshell
       if(id.gt.kd_j5_q6) Call DET_stop(j,q,id)
       MJ = MD_j5_q6(id)
       Idet(1:q)= Idet_j5_q6(1:q,id)
      CASE(702)                                   !  [7/2]^2 - subshell
       if(id.gt.kd_j7_q2) Call DET_stop(j,q,id)
       MJ = MD_j7_q2(id)
       Idet(1:q)= Idet_j7_q2(1:q,id)
      CASE(703)                                   !  [7/2]^3 - subshell
       if(id.gt.kd_j7_q3) Call DET_stop(j,q,id)
       MJ = MD_j7_q3(id)
       Idet(1:q)= Idet_j7_q3(1:q,id)
      CASE(704)                                   !  [7/2]^4 - subshell
       if(id.gt.kd_j7_q4) Call DET_stop(j,q,id)
       MJ = MD_j7_q4(id)
       Idet(1:q)= Idet_j7_q4(1:q,id)
      CASE(705)                                   !  [7/2]^5 - subshell
       if(id.gt.kd_j7_q5) Call DET_stop(j,q,id)
       MJ = MD_j7_q5(id)
       Idet(1:q)= Idet_j7_q5(1:q,id)
      CASE(706)                                   !  [7/2]^6 - subshell
       if(id.gt.kd_j7_q6) Call DET_stop(j,q,id)
       MJ = MD_j7_q6(id)
       Idet(1:q)= Idet_j7_q6(1:q,id)
      CASE(707)                                   !  [7/2]^7 - subshell
       if(id.gt.kd_j7_q7) Call DET_stop(j,q,id)
       MJ = MD_j7_q7(id)
       Idet(1:q)= Idet_j7_q7(1:q,id)
      CASE(708)                                   !  [7/2]^8 - subshell
       if(id.gt.kd_j7_q8) Call DET_stop(j,q,id)
       MJ = MD_j7_q8(id)
       Idet(1:q)= Idet_j7_q8(1:q,id)
      CASE(902)                                   !  [9/2]^2 - subshell
       if(id.gt.kd_j9_q2) Call DET_stop(j,q,id)
       MJ = MD_j9_q2(id)
       Idet(1:q)= Idet_j9_q2(1:q,id)
      CASE(1102)                                  ! [11/2]^2 - subshell
       if(id.gt.kd_j11_q2) Call DET_stop(j,q,id)
       MJ = MD_j11_q2(id)
       Idet(1:q)= Idet_j11_q2(1:q,id)
      Case default
        Call DET_stop(j,q,id)
      END SELECT

      end if

      End  Subroutine  DET_sh_jq


!======================================================================
      Subroutine DET_stop (j,q,id)
!======================================================================       
!     stops execution of DET_sh_jq with debug information
!---------------------------------------------------------------------- 
      Integer, intent(in) :: j,q,id
      write(*,'(a,a,3i5)') 'DET_sh_jq: id is out the range: ',  &
                           'j,q,id = ',j,q,id
      Stop  'DET_sh_jq: id is out the range:'
      End Subroutine DET_stop


!======================================================================
      Real(8) Function  DETC_jq (j,q,it,id)
!======================================================================
!     gives the expansion coefficient for the given subshell 'jq',
!     term 'it' and determinant 'id'
!     Input:  jq - subshell
!             it - the term number
!             id - the determinant number
!     Calls:  CLEBSH2, MJ_value
!----------------------------------------------------------------------
      Use det_jq

      Implicit none
      Integer, Intent(in) :: j,q,it,id
      Integer :: i,i1,i2,k,mj,mj1,mj2,JT,JV,JW,JQ,nd,nq
      Integer, external :: MJ_value, Jterm
      Real(8) :: C
      Real(8), external :: Clebsh2

      if(it.le.0.or.id.le.0) Call DETC_stop(j,q,it,id)
!----------------------------------------------------------------------
! ... two-electron case for j > 11/2, the only case we should compute:

      if(q.eq.2.and.j.gt.11) then

       if(it.gt.(j+1)/2) Call DETC_stop(j,q,it,id)
       nq=j+1; nd=nq*(nq-1)/2; if(id.gt.nd) Call DET_stop(j,q,id)
       if(id.gt.nd) Call DETC_stop(j,q,it,id)
       k=0
       Do i1=1,nq-1;
        Do i2=i1+1,nq
         k=k+1
         if(k.eq.id) Exit
        End do
        if(k.eq.id) Exit
       End do
       mj1 = MJ_value(i1);  mj2 = MJ_value(i2); MJ = mj1+mj2

       i = Jterm(j,q,it,JT,JV,JW,JQ)                   !  ???
       DETC_jq = CLEBSH2(j,mj1,j,mj2,JT,MJ)
       Return

!----------------------------------------------------------------------

      elseif(q.eq.1) then                         !  one-electron shell

       if(it.ne.1.or.id.gt.j+1) Call DETC_stop(j,q,it,id)
       DETC_jq = 1.d0
       Return

      else

      SELECT CASE(j*100+q)

      CASE(102)                                    ! [1/2]^2 - subshell
       if(it.gt.nt_j1_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j1_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j1_q2(it,id)
       i2=JD_j1_q2(it,id)
      CASE(302)                                    ! [3/2]^2 - subshell
       if(it.gt.nt_j3_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j3_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j3_q2(it,id)
       i2=JD_j3_q2(it,id)
      CASE(303)                                    ! [3/2]^3 - subshell
       if(it.gt.nt_j3_q3) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j3_q3) Call DETC_stop(j,q,it,id)
       i1=ID_j3_q3(it,id)
       i2=JD_j3_q3(it,id)
      CASE(304)                                    ! [3/2]^4 - subshell
       if(it.gt.nt_j3_q4) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j3_q4) Call DETC_stop(j,q,it,id)
       i1=ID_j3_q4(it,id)
       i2=JD_j3_q4(it,id)
      CASE(502)                                    ! [5/2]^2 - subshell
       if(it.gt.nt_j5_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j5_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j5_q2(it,id)
       i2=JD_j5_q2(it,id)
      CASE(503)                                    ! [5/2]^3 - subshell
       if(it.gt.nt_j5_q3) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j5_q3) Call DETC_stop(j,q,it,id)
       i1=ID_j5_q3(it,id)
       i2=JD_j5_q3(it,id)
      CASE(504)                                    ! [5/2]^4 - subshell
       if(it.gt.nt_j5_q4) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j5_q4) Call DETC_stop(j,q,it,id)
       i1=ID_j5_q4(it,id)
       i2=JD_j5_q4(it,id)
      CASE(505)                                    ! [5/2]^5 - subshell
       if(it.gt.nt_j5_q5) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j5_q5) Call DETC_stop(j,q,it,id)
       i1=ID_j5_q5(it,id)
       i2=JD_j5_q5(it,id)
      CASE(506)                                    ! [5/2]^6 - subshell
       if(it.gt.nt_j5_q6) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j5_q6) Call DETC_stop(j,q,it,id)
       i1=ID_j5_q6(it,id)
       i2=JD_j5_q6(it,id)
      CASE(702)                                    ! [7/2]^2 - subshell
       if(it.gt.nt_j7_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q2(it,id)
       i2=JD_j7_q2(it,id)
      CASE(703)                                    ! [7/2]^3 - subshell
       if(it.gt.nt_j7_q3) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q3) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q3(it,id)
       i2=JD_j7_q3(it,id)
      CASE(704)                                    ! [7/2]^4 - subshell
       if(it.gt.nt_j7_q4) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q4) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q4(it,id)
       i2=JD_j7_q4(it,id)
      CASE(705)                                    ! [7/2]^5 - subshell
       if(it.gt.nt_j7_q5) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q5) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q5(it,id)
       i2=JD_j7_q5(it,id)
      CASE(706)                                    ! [7/2]^6 - subshell
       if(it.gt.nt_j7_q6) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q6) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q6(it,id)
       i2=JD_j7_q6(it,id)
      CASE(707)                                    ! [7/2]^7 - subshell
       if(it.gt.nt_j7_q7) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q7) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q7(it,id)
       i2=JD_j7_q7(it,id)
      CASE(708)                                    ! [7/2]^8 - subshell
       if(it.gt.nt_j7_q8) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j7_q8) Call DETC_stop(j,q,it,id)
       i1=ID_j7_q8(it,id)
       i2=JD_j7_q8(it,id)
      CASE(902)                                    ! [9/2]^2 - subshell
       if(it.gt.nt_j9_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j9_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j9_q2(it,id)
       i2=JD_j9_q2(it,id)
      CASE(1102)                                    ![11/2]^2 - subshell
       if(it.gt.nt_j11_q2) Call DETC_stop(j,q,it,id)
       if(id.gt.kd_j11_q2) Call DETC_stop(j,q,it,id)
       i1=ID_j11_q2(it,id)
       i2=JD_j11_q2(it,id)

      CASE DEFAULT

       write(*,*) ' j,q = ',j,q
       Stop ' DETC_jq: jq - outside of possible values'

      END SELECT
      end if
 
      C=DBLE(i1)/DBLE(i2); C=sqrt(abs(C)); if(i1.lt.0) C=-C; DETC_jq=C

      End  Function  DETC_jq


!======================================================================
      Subroutine DETC_stop (j,q,it,id)
!======================================================================       
!     stops execution of DETC_jq with debug information
!---------------------------------------------------------------------- 
      Integer, intent(in) :: j,q,it,id
      write(6,'(a,a,4i5)') 'DETC_jq: it(id) is out the range: ',  &
                           'j,q,it,id = ',j,q,it,id
      Stop  'DETC_jq: it(id) is out the range:'
      End Subroutine DETC_stop


