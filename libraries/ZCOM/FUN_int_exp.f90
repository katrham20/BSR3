!======================================================================
      Subroutine INT_EXP(X,E)
!======================================================================
!     Values of exponential integrals: INT[z^-n exp(-zx) dz; 1,inf]
!----------------------------------------------------------------------
      Implicit real *8 (A-H,O-Z)

      Real(8) :: E(0:5)

      DATA A0/-0.57721566/, A1/ 0.99999193/, A2/-0.24991055/,  &
           A3/ 0.05519968/, A4/-0.00976004/, A5/ 0.00107857/,  &
           B1/ 8.5733287401/, B2/18.0590169730/,               &
           B3/ 8.6347608925/, B4/ 0.2677737343/,               &
           C1/ 9.5733223454/, C2/25.6329561486/,               &
           C3/21.0996530827/, C4/ 3.9584969229/

      if(x.le.0) Stop ' INT_EXP:  x <= 0 '

      X1=X;  X2=X1*X;  X3=X2*X;  X4=X3*X; X5=X4*X
      E(0) = exp(-x)/x

      IF(X.LE.1.0) THEN
        E(1) = -LOG(X) + A0+A1*X1+A2*X2+A3*X3+A4*X4+A5*X5
      ELSE
        E(1) = (X4+B1*X3+B2*X2+B3*X+B4)/            &
               (X4+C1*X3+C2*X2+C3*X+C4) * E(0)
      END IF

      Do i = 2,5
       E(i) = (EXP(-X) - X*E(i-1))/(i-1)
      End do

      if(x.gt.20) then
       Do n = 3,5
        S = 1.0
        xn = x+n
        yn = xn*xn
        S = S + n/yn
        zn = yn*yn
        S = S + n*(n-2*x)/zn
        zn = zn*yn
        S = S + n*(6*x*x-8*n*x+n*n)/zn
        E(n) = S * x / xn * E(0)
       End do
      end if

      End Subroutine INT_EXP


!======================================================================
      Real(8) Function EXP_INT1(X)
!======================================================================
!     Values of exponential integral: INT[ exp(-zx)/z dz; 1,inf]
!----------------------------------------------------------------------
      Implicit real *8 (A-H,O-Z)

      DATA A0/-0.57721566/, A1/ 0.99999193/, A2/-0.24991055/,  &
           A3/ 0.05519968/, A4/-0.00976004/, A5/ 0.00107857/,  &
           B1/ 8.5733287401/, B2/18.0590169730/,               &
           B3/ 8.6347608925/, B4/ 0.2677737343/,               &
           C1/ 9.5733223454/, C2/25.6329561486/,               &
           C3/21.0996530827/, C4/ 3.9584969229/

      if(x.le.0) Stop ' INT_EXP1:  x <= 0 '

      X1=X; X2=X1*X; X3=X2*X; X4=X3*X; X5=X4*X

      IF(X.LE.1.d0) THEN
        Exp_int1 = -LOG(X) + A0+A1*X1+A2*X2+A3*X3+A4*X4+A5*X5
      ELSE
        Exp_int1 = (X4+B1*X3+B2*X2+B3*X+B4)/  &
                   (X4+C1*X3+C2*X2+C3*X+C4)   * exp(-x)/x
      END IF

      END function EXP_INT1


!======================================================================
      Real(8) function EXP_LOG(a,t)
!======================================================================
!     Values of integral: INT[ log(x) exp(-x/t) d(x/t); a,inf]
!----------------------------------------------------------------------
      Implicit real(8) (A-H,O-Z)

      EXP_LOG = EXP_INT1(a/t) + log(a)*exp(-a/t)

      End function EXP_LOG
