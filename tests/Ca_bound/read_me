
#  test run for bound states and oscillator strengths
#  calculations in Ca

#  we are working in the frozen-core approximation and represent
#  the Ca atomic states through expansion other  Ca+ ionic states

#  the model includes 6 Ca+ states: 4s,4p,3d,5s,5p,4d
#  these states are supposed to be obtained in some MCHF calculations
#  and represented as pair of name.c and name.w files:

#   4s.c,  4p.c,  3d.c,  5s.c,  5p.c,  4d.c
#   4s.w,  4p.w,  3d.w,  5s.w,  5p.w,  4d.w                                                                                                     

#  Folder Ca_bound contains the results, whereas
#  subfolder "initial_data_save" contains the data that 
#  you should prepare to begin the calculations

#--------------------------------------------------------------     step 1
#  preparation of ionic states orbitals in BSR-format:

#  we need choose B-spline grid and create knot.dat file;
#  usually, we just copy knot.dat from some other calculations
#  and change a few parameters if needed

#  prepare bsw-files from w-files using the utility "w_bsw"

w_bsw  4s.w
w_bsw  4p.w
w_bsw  3d.w
w_bsw  5s.w
w_bsw  5p.w
w_bsw  4d.w

#  it is a quick procedure; at this stage you may play with
#  B-spline parameters to choose most appropriate;
#  all other calculations should used the same knot.dat file
#  without changes

#--------------------------------------------------------------     step 2

#  prepare 'target' file which contain list of ionic states
#  and desirade total terms for Ca states 
#  (see target.0 as example of inital target file, this file 
#   will be furher changed and added by programs bsr_prep and bsr_conf) 

#  prepare bsr_par file with specific paramters 
#  this file can be empty if only default parametrs are used

#  run the first preparation programs:

bsr_prep3
bsr_conf3 

#  at this stage you may chack the size of resultiong expansions
#  and other details in file target and log-files

#--------------------------------------------------------------     step 3
#  bound-state B-spline calculations for given terms:

bsr_breit3 klsp1=1 klsp2=14 
bsr_mat3 klsp1=1 klsp2=14
bsr_hd3 klsp1=1 klsp2=14  itype=-1  msol=10

bound_tab

#  "bound_tab" file will contain the list of bound states obtained;
#   you change the parameters in the end of file to change the output,
#   i.e, binding or excitation energies, specific partial waves, etc.


#----------------------------------------------------------------   step 4
#  extract specific states for following calculations 
#  for e-Ca problem:

   To do that, we need prepare bound_bsw.inp file, which contains
   index of solution, index of partial wave, name of the states.
   (one line for each state)

   It is the similar information as in the bound_tab file, so practically
   we just need to copy the corresponding lines from the bound_tab file.
   Here we need to check the names given for the solutions by the bsr_hd
   program - they can be wrong or confusing. 
   If you using the bound_bsw.inp file with name, when you just run
   
bound_bsw  

   The output will contain the pairs  name.c and name.bsw for each chosen state.

   If there are too many states and checking the name is difficult,
   there is option to run with some generic names:

bound_bsw  mode=sol

   In this case, the output for each state will contain files:
       sol_nnn_mmmm.c  and  sol_nnn_mmmm.bsw
   where nnn - partial wave index, mmmm - index of solution for given term

#----------------------------------------------------------------  step 5
#  calculation of oscilator strengths:

#  consider as exmaple the oscillation strenths from the ground state, 4s2 1S,
#  to the excited 1Po states. 
#  Acording the target file, 1S states are in 1st partial wave, 1Po states are
#  in 3rd partial wave

mult3  cfg.001 cfg.003 E1
bsr_dmat3  cfg.001 cfg.003 b b  istate1=1  mstate2=10

#  results are in file "zf_res"




    










   






 

